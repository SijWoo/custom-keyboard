ARM GAS  /tmp/ccmNIA1d.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"os_sem.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.OSSemCreate,"ax",%progbits
  18              		.align	1
  19              		.global	OSSemCreate
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	OSSemCreate:
  27              	.LVL0:
  28              	.LFB0:
  29              		.file 1 "rtos/uCOS-III/Source/os_sem.c"
   1:rtos/uCOS-III/Source/os_sem.c **** /*
   2:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
   3:rtos/uCOS-III/Source/os_sem.c **** *                                                uC/OS-III
   4:rtos/uCOS-III/Source/os_sem.c **** *                                          The Real-Time Kernel
   5:rtos/uCOS-III/Source/os_sem.c **** *
   6:rtos/uCOS-III/Source/os_sem.c **** *                         (c) Copyright 2009-2019; Silicon Laboratories Inc.,
   7:rtos/uCOS-III/Source/os_sem.c **** *                                400 W. Cesar Chavez, Austin, TX 78701
   8:rtos/uCOS-III/Source/os_sem.c **** *
   9:rtos/uCOS-III/Source/os_sem.c **** *                   All rights reserved. Protected by international copyright laws.
  10:rtos/uCOS-III/Source/os_sem.c **** *
  11:rtos/uCOS-III/Source/os_sem.c **** *                  Your use of this software is subject to your acceptance of the terms
  12:rtos/uCOS-III/Source/os_sem.c **** *                  of a Silicon Labs Micrium software license, which can be obtained by
  13:rtos/uCOS-III/Source/os_sem.c **** *                  contacting info@micrium.com. If you do not agree to the terms of this
  14:rtos/uCOS-III/Source/os_sem.c **** *                  license, you may not use this software.
  15:rtos/uCOS-III/Source/os_sem.c **** *
  16:rtos/uCOS-III/Source/os_sem.c **** *                  Please help us continue to provide the Embedded community with the finest
  17:rtos/uCOS-III/Source/os_sem.c **** *                  software available. Your honesty is greatly appreciated.
  18:rtos/uCOS-III/Source/os_sem.c **** *
  19:rtos/uCOS-III/Source/os_sem.c **** *                    You can find our product's documentation at: doc.micrium.com
  20:rtos/uCOS-III/Source/os_sem.c **** *
  21:rtos/uCOS-III/Source/os_sem.c **** *                          For more information visit us at: www.micrium.com
  22:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
  23:rtos/uCOS-III/Source/os_sem.c **** */
  24:rtos/uCOS-III/Source/os_sem.c **** 
  25:rtos/uCOS-III/Source/os_sem.c **** /*
  26:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
  27:rtos/uCOS-III/Source/os_sem.c **** *                                         SEMAPHORE MANAGEMENT
  28:rtos/uCOS-III/Source/os_sem.c **** *
  29:rtos/uCOS-III/Source/os_sem.c **** * File    : os_sem.c
ARM GAS  /tmp/ccmNIA1d.s 			page 2


  30:rtos/uCOS-III/Source/os_sem.c **** * Version : V3.07.04
  31:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
  32:rtos/uCOS-III/Source/os_sem.c **** */
  33:rtos/uCOS-III/Source/os_sem.c **** 
  34:rtos/uCOS-III/Source/os_sem.c **** #define  MICRIUM_SOURCE
  35:rtos/uCOS-III/Source/os_sem.c **** #include "os.h"
  36:rtos/uCOS-III/Source/os_sem.c **** 
  37:rtos/uCOS-III/Source/os_sem.c **** #ifdef VSC_INCLUDE_SOURCE_FILE_NAMES
  38:rtos/uCOS-III/Source/os_sem.c **** const  CPU_CHAR  *os_sem__c = "$Id: $";
  39:rtos/uCOS-III/Source/os_sem.c **** #endif
  40:rtos/uCOS-III/Source/os_sem.c **** 
  41:rtos/uCOS-III/Source/os_sem.c **** 
  42:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_SEM_EN > 0u)
  43:rtos/uCOS-III/Source/os_sem.c **** /*
  44:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
  45:rtos/uCOS-III/Source/os_sem.c **** *                                                  CREATE A SEMAPHORE
  46:rtos/uCOS-III/Source/os_sem.c **** *
  47:rtos/uCOS-III/Source/os_sem.c **** * Description: This function creates a semaphore.
  48:rtos/uCOS-III/Source/os_sem.c **** *
  49:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem         is a pointer to the semaphore to initialize.  Your application is resp
  50:rtos/uCOS-III/Source/os_sem.c **** *                            allocating storage for the semaphore.
  51:rtos/uCOS-III/Source/os_sem.c **** *
  52:rtos/uCOS-III/Source/os_sem.c **** *              p_name        is a pointer to the name you would like to give the semaphore.
  53:rtos/uCOS-III/Source/os_sem.c **** *
  54:rtos/uCOS-III/Source/os_sem.c **** *              cnt           is the initial value for the semaphore.
  55:rtos/uCOS-III/Source/os_sem.c **** *                            If used to share resources, you should initialize to the number of res
  56:rtos/uCOS-III/Source/os_sem.c **** *                            If used to signal the occurrence of event(s) then you should initializ
  57:rtos/uCOS-III/Source/os_sem.c **** *
  58:rtos/uCOS-III/Source/os_sem.c **** *              p_err         is a pointer to a variable that will contain an error code returned by
  59:rtos/uCOS-III/Source/os_sem.c **** *
  60:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_NONE                    If the call was successful
  61:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_CREATE_ISR              If you called this function from an
  62:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_ILLEGAL_CREATE_RUN_TIME If you are trying to create the sem
  63:rtos/uCOS-III/Source/os_sem.c **** *                                                                 called OSSafetyCriticalStart()
  64:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_PTR_NULL            If 'p_sem'  is a NULL pointer
  65:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_CREATED             If the semaphore was already create
  66:rtos/uCOS-III/Source/os_sem.c **** *
  67:rtos/uCOS-III/Source/os_sem.c **** * Returns    : none
  68:rtos/uCOS-III/Source/os_sem.c **** *
  69:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : none
  70:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
  71:rtos/uCOS-III/Source/os_sem.c **** */
  72:rtos/uCOS-III/Source/os_sem.c **** 
  73:rtos/uCOS-III/Source/os_sem.c **** void  OSSemCreate (OS_SEM      *p_sem,
  74:rtos/uCOS-III/Source/os_sem.c ****                    CPU_CHAR    *p_name,
  75:rtos/uCOS-III/Source/os_sem.c ****                    OS_SEM_CTR   cnt,
  76:rtos/uCOS-III/Source/os_sem.c ****                    OS_ERR      *p_err)
  77:rtos/uCOS-III/Source/os_sem.c **** {
  30              		.loc 1 77 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 77 1 is_stmt 0 view .LVU1
  35 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 24
  38              		.cfi_offset 3, -24
ARM GAS  /tmp/ccmNIA1d.s 			page 3


  39              		.cfi_offset 4, -20
  40              		.cfi_offset 5, -16
  41              		.cfi_offset 6, -12
  42              		.cfi_offset 7, -8
  43              		.cfi_offset 14, -4
  44 0002 1D46     		mov	r5, r3
  78:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
  45              		.loc 1 78 5 is_stmt 1 view .LVU2
  46              	.LVL1:
  79:rtos/uCOS-III/Source/os_sem.c **** 
  80:rtos/uCOS-III/Source/os_sem.c **** 
  81:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
  82:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
  83:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
  84:rtos/uCOS-III/Source/os_sem.c ****         return;
  85:rtos/uCOS-III/Source/os_sem.c ****     }
  86:rtos/uCOS-III/Source/os_sem.c **** #endif
  87:rtos/uCOS-III/Source/os_sem.c **** 
  88:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL_IEC61508
  89:rtos/uCOS-III/Source/os_sem.c ****     if (OSSafetyCriticalStartFlag == OS_TRUE) {
  90:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_ILLEGAL_CREATE_RUN_TIME;
  91:rtos/uCOS-III/Source/os_sem.c ****         return;
  92:rtos/uCOS-III/Source/os_sem.c ****     }
  93:rtos/uCOS-III/Source/os_sem.c **** #endif
  94:rtos/uCOS-III/Source/os_sem.c **** 
  95:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_CALLED_FROM_ISR_CHK_EN > 0u)
  96:rtos/uCOS-III/Source/os_sem.c ****     if (OSIntNestingCtr > 0u) {                                 /* Not allowed to be called from an
  47              		.loc 1 96 5 view .LVU3
  48              		.loc 1 96 25 is_stmt 0 view .LVU4
  49 0004 1349     		ldr	r1, .L10
  50              	.LVL2:
  51              		.loc 1 96 25 view .LVU5
  52 0006 0978     		ldrb	r1, [r1]	@ zero_extendqisi2
  53              		.loc 1 96 8 view .LVU6
  54 0008 B1B9     		cbnz	r1, .L7
  55 000a 0446     		mov	r4, r0
  56 000c 1646     		mov	r6, r2
  97:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_CREATE_ISR;
  98:rtos/uCOS-III/Source/os_sem.c ****         return;
  99:rtos/uCOS-III/Source/os_sem.c ****     }
 100:rtos/uCOS-III/Source/os_sem.c **** #endif
 101:rtos/uCOS-III/Source/os_sem.c **** 
 102:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 103:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
  57              		.loc 1 103 5 is_stmt 1 view .LVU7
  58              		.loc 1 103 8 is_stmt 0 view .LVU8
  59 000e B8B1     		cbz	r0, .L8
 104:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 105:rtos/uCOS-III/Source/os_sem.c ****         return;
 106:rtos/uCOS-III/Source/os_sem.c ****     }
 107:rtos/uCOS-III/Source/os_sem.c **** #endif
 108:rtos/uCOS-III/Source/os_sem.c **** 
 109:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
  60              		.loc 1 109 5 is_stmt 1 view .LVU9
  61              		.loc 1 109 5 view .LVU10
  62              		.loc 1 109 5 view .LVU11
  63 0010 4020     		movs	r0, #64
ARM GAS  /tmp/ccmNIA1d.s 			page 4


  64              	.LVL3:
  65              		.loc 1 109 5 is_stmt 0 view .LVU12
  66 0012 FFF7FEFF 		bl	CPU_SR_Save
  67              	.LVL4:
  68              		.loc 1 109 5 view .LVU13
  69 0016 0746     		mov	r7, r0
  70              	.LVL5:
  71              		.loc 1 109 5 is_stmt 1 view .LVU14
  72              		.loc 1 109 5 view .LVU15
 110:rtos/uCOS-III/Source/os_sem.c **** #if (OS_OBJ_TYPE_REQ > 0u)
 111:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type == OS_OBJ_TYPE_SEM) {
  73              		.loc 1 111 5 view .LVU16
  74              		.loc 1 111 14 is_stmt 0 view .LVU17
  75 0018 2268     		ldr	r2, [r4]
  76              		.loc 1 111 8 view .LVU18
  77 001a 0F4B     		ldr	r3, .L10+4
  78 001c 9A42     		cmp	r2, r3
  79 001e 13D0     		beq	.L9
 112:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 113:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 114:rtos/uCOS-III/Source/os_sem.c ****         return;
 115:rtos/uCOS-III/Source/os_sem.c ****     }
 116:rtos/uCOS-III/Source/os_sem.c ****     p_sem->Type    = OS_OBJ_TYPE_SEM;                           /* Mark the data structure as a sem
  80              		.loc 1 116 5 is_stmt 1 view .LVU19
  81              		.loc 1 116 20 is_stmt 0 view .LVU20
  82 0020 0D4B     		ldr	r3, .L10+4
  83 0022 2360     		str	r3, [r4]
 117:rtos/uCOS-III/Source/os_sem.c **** #endif
 118:rtos/uCOS-III/Source/os_sem.c ****     p_sem->Ctr     = cnt;                                       /* Set semaphore value             
  84              		.loc 1 118 5 is_stmt 1 view .LVU21
  85              		.loc 1 118 20 is_stmt 0 view .LVU22
  86 0024 E660     		str	r6, [r4, #12]
 119:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 120:rtos/uCOS-III/Source/os_sem.c ****     p_sem->TS      = 0u;
 121:rtos/uCOS-III/Source/os_sem.c **** #endif
 122:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 123:rtos/uCOS-III/Source/os_sem.c ****     p_sem->NamePtr = p_name;                                    /* Save the name of the semaphore  
 124:rtos/uCOS-III/Source/os_sem.c **** #else
 125:rtos/uCOS-III/Source/os_sem.c ****     (void)p_name;
  87              		.loc 1 125 5 is_stmt 1 view .LVU23
 126:rtos/uCOS-III/Source/os_sem.c **** #endif
 127:rtos/uCOS-III/Source/os_sem.c ****     OS_PendListInit(&p_sem->PendList);                          /* Initialize the waiting list     
  88              		.loc 1 127 5 view .LVU24
  89 0026 201D     		adds	r0, r4, #4
  90              	.LVL6:
  91              		.loc 1 127 5 is_stmt 0 view .LVU25
  92 0028 FFF7FEFF 		bl	OS_PendListInit
  93              	.LVL7:
 128:rtos/uCOS-III/Source/os_sem.c **** 
 129:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 130:rtos/uCOS-III/Source/os_sem.c ****     OS_SemDbgListAdd(p_sem);
 131:rtos/uCOS-III/Source/os_sem.c ****     OSSemQty++;
 132:rtos/uCOS-III/Source/os_sem.c **** #endif
 133:rtos/uCOS-III/Source/os_sem.c **** 
 134:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_CREATE(p_sem, p_name);
  94              		.loc 1 134 39 is_stmt 1 view .LVU26
 135:rtos/uCOS-III/Source/os_sem.c **** 
ARM GAS  /tmp/ccmNIA1d.s 			page 5


 136:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
  95              		.loc 1 136 5 view .LVU27
  96              		.loc 1 136 5 view .LVU28
  97              		.loc 1 136 5 view .LVU29
  98 002c 3846     		mov	r0, r7
  99 002e FFF7FEFF 		bl	CPU_SR_Restore
 100              	.LVL8:
 101              		.loc 1 136 5 view .LVU30
 102              		.loc 1 136 5 view .LVU31
 137:rtos/uCOS-III/Source/os_sem.c ****    *p_err = OS_ERR_NONE;
 103              		.loc 1 137 4 view .LVU32
 104              		.loc 1 137 11 is_stmt 0 view .LVU33
 105 0032 0023     		movs	r3, #0
 106 0034 2B80     		strh	r3, [r5]	@ movhi
 107              	.LVL9:
 108              	.L1:
 138:rtos/uCOS-III/Source/os_sem.c **** }
 109              		.loc 1 138 1 view .LVU34
 110 0036 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 111              	.LVL10:
 112              	.L7:
  97:rtos/uCOS-III/Source/os_sem.c ****         return;
 113              		.loc 1 97 8 is_stmt 1 view .LVU35
  97:rtos/uCOS-III/Source/os_sem.c ****         return;
 114              		.loc 1 97 15 is_stmt 0 view .LVU36
 115 0038 42F6E163 		movw	r3, #12001
 116              	.LVL11:
  97:rtos/uCOS-III/Source/os_sem.c ****         return;
 117              		.loc 1 97 15 view .LVU37
 118 003c 2B80     		strh	r3, [r5]	@ movhi
  98:rtos/uCOS-III/Source/os_sem.c ****     }
 119              		.loc 1 98 9 is_stmt 1 view .LVU38
 120 003e FAE7     		b	.L1
 121              	.LVL12:
 122              	.L8:
 104:rtos/uCOS-III/Source/os_sem.c ****         return;
 123              		.loc 1 104 8 view .LVU39
 104:rtos/uCOS-III/Source/os_sem.c ****         return;
 124              		.loc 1 104 15 is_stmt 0 view .LVU40
 125 0040 45F6C353 		movw	r3, #24003
 126              	.LVL13:
 104:rtos/uCOS-III/Source/os_sem.c ****         return;
 127              		.loc 1 104 15 view .LVU41
 128 0044 2B80     		strh	r3, [r5]	@ movhi
 105:rtos/uCOS-III/Source/os_sem.c ****     }
 129              		.loc 1 105 9 is_stmt 1 view .LVU42
 130 0046 F6E7     		b	.L1
 131              	.LVL14:
 132              	.L9:
 112:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 133              		.loc 1 112 9 view .LVU43
 112:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 134              		.loc 1 112 9 view .LVU44
 112:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 135              		.loc 1 112 9 view .LVU45
 136 0048 FFF7FEFF 		bl	CPU_SR_Restore
 137              	.LVL15:
ARM GAS  /tmp/ccmNIA1d.s 			page 6


 112:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 138              		.loc 1 112 9 view .LVU46
 112:rtos/uCOS-III/Source/os_sem.c ****         *p_err = OS_ERR_OBJ_CREATED;
 139              		.loc 1 112 9 view .LVU47
 113:rtos/uCOS-III/Source/os_sem.c ****         return;
 140              		.loc 1 113 9 view .LVU48
 113:rtos/uCOS-III/Source/os_sem.c ****         return;
 141              		.loc 1 113 16 is_stmt 0 view .LVU49
 142 004c 45F6C153 		movw	r3, #24001
 143 0050 2B80     		strh	r3, [r5]	@ movhi
 114:rtos/uCOS-III/Source/os_sem.c ****     }
 144              		.loc 1 114 9 is_stmt 1 view .LVU50
 145 0052 F0E7     		b	.L1
 146              	.L11:
 147              		.align	2
 148              	.L10:
 149 0054 00000000 		.word	OSIntNestingCtr
 150 0058 53454D41 		.word	1095583059
 151              		.cfi_endproc
 152              	.LFE0:
 154              		.section	.text.OSSemPend,"ax",%progbits
 155              		.align	1
 156              		.global	OSSemPend
 157              		.syntax unified
 158              		.thumb
 159              		.thumb_func
 160              		.fpu fpv4-sp-d16
 162              	OSSemPend:
 163              	.LVL16:
 164              	.LFB2:
 139:rtos/uCOS-III/Source/os_sem.c **** 
 140:rtos/uCOS-III/Source/os_sem.c **** 
 141:rtos/uCOS-III/Source/os_sem.c **** /*
 142:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 143:rtos/uCOS-III/Source/os_sem.c **** *                                                  DELETE A SEMAPHORE
 144:rtos/uCOS-III/Source/os_sem.c **** *
 145:rtos/uCOS-III/Source/os_sem.c **** * Description: This function deletes a semaphore.
 146:rtos/uCOS-III/Source/os_sem.c **** *
 147:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem         is a pointer to the semaphore to delete
 148:rtos/uCOS-III/Source/os_sem.c **** *
 149:rtos/uCOS-III/Source/os_sem.c **** *              opt           determines delete options as follows:
 150:rtos/uCOS-III/Source/os_sem.c **** *
 151:rtos/uCOS-III/Source/os_sem.c **** *                                OS_OPT_DEL_NO_PEND          Delete semaphore ONLY if no task pendi
 152:rtos/uCOS-III/Source/os_sem.c **** *                                OS_OPT_DEL_ALWAYS           Deletes the semaphore even if tasks ar
 153:rtos/uCOS-III/Source/os_sem.c **** *                                                            In this case, all the tasks pending wi
 154:rtos/uCOS-III/Source/os_sem.c **** *
 155:rtos/uCOS-III/Source/os_sem.c **** *              p_err         is a pointer to a variable that will contain an error code returned by
 156:rtos/uCOS-III/Source/os_sem.c **** *
 157:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_NONE                    The call was successful and the sem
 158:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_DEL_ISR                 If you attempted to delete the sema
 159:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_ILLEGAL_DEL_RUN_TIME    If you are trying to delete the sem
 160:rtos/uCOS-III/Source/os_sem.c **** *                                                                 OSStart()
 161:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_PTR_NULL            If 'p_sem' is a NULL pointer
 162:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_TYPE                If 'p_sem' is not pointing at a sem
 163:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OPT_INVALID             An invalid option was specified
 164:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OS_NOT_RUNNING          If uC/OS-III is not running yet
 165:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_TASK_WAITING            One or more tasks were waiting on t
ARM GAS  /tmp/ccmNIA1d.s 			page 7


 166:rtos/uCOS-III/Source/os_sem.c **** *
 167:rtos/uCOS-III/Source/os_sem.c **** * Returns    : == 0          if no tasks were waiting on the semaphore, or upon error.
 168:rtos/uCOS-III/Source/os_sem.c **** *              >  0          if one or more tasks waiting on the semaphore are now readied and info
 169:rtos/uCOS-III/Source/os_sem.c **** *
 170:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : 1) This function must be used with care.  Tasks that would normally expect the prese
 171:rtos/uCOS-III/Source/os_sem.c **** *                 MUST check the return code of OSSemPend().
 172:rtos/uCOS-III/Source/os_sem.c **** *              2) Because ALL tasks pending on the semaphore will be readied, you MUST be careful i
 173:rtos/uCOS-III/Source/os_sem.c **** *                 the semaphore is used for mutual exclusion because the resource(s) will no longer
 174:rtos/uCOS-III/Source/os_sem.c **** *                 semaphore.
 175:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 176:rtos/uCOS-III/Source/os_sem.c **** */
 177:rtos/uCOS-III/Source/os_sem.c **** 
 178:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_SEM_DEL_EN > 0u)
 179:rtos/uCOS-III/Source/os_sem.c **** OS_OBJ_QTY  OSSemDel (OS_SEM  *p_sem,
 180:rtos/uCOS-III/Source/os_sem.c ****                       OS_OPT   opt,
 181:rtos/uCOS-III/Source/os_sem.c ****                       OS_ERR  *p_err)
 182:rtos/uCOS-III/Source/os_sem.c **** {
 183:rtos/uCOS-III/Source/os_sem.c ****     OS_OBJ_QTY     nbr_tasks;
 184:rtos/uCOS-III/Source/os_sem.c ****     OS_PEND_LIST  *p_pend_list;
 185:rtos/uCOS-III/Source/os_sem.c ****     OS_TCB        *p_tcb;
 186:rtos/uCOS-III/Source/os_sem.c ****     CPU_TS         ts;
 187:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 188:rtos/uCOS-III/Source/os_sem.c **** 
 189:rtos/uCOS-III/Source/os_sem.c **** 
 190:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
 191:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
 192:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
 193:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 194:rtos/uCOS-III/Source/os_sem.c ****     }
 195:rtos/uCOS-III/Source/os_sem.c **** #endif
 196:rtos/uCOS-III/Source/os_sem.c **** 
 197:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_DEL_ENTER(p_sem, opt);
 198:rtos/uCOS-III/Source/os_sem.c **** 
 199:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL_IEC61508
 200:rtos/uCOS-III/Source/os_sem.c ****     if (OSSafetyCriticalStartFlag == OS_TRUE) {
 201:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_ILLEGAL_DEL_RUN_TIME);
 202:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_ILLEGAL_DEL_RUN_TIME;
 203:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 204:rtos/uCOS-III/Source/os_sem.c ****     }
 205:rtos/uCOS-III/Source/os_sem.c **** #endif
 206:rtos/uCOS-III/Source/os_sem.c **** 
 207:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_CALLED_FROM_ISR_CHK_EN > 0u)
 208:rtos/uCOS-III/Source/os_sem.c ****     if (OSIntNestingCtr > 0u) {                                 /* Not allowed to delete a semaphor
 209:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_DEL_ISR);
 210:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_DEL_ISR;
 211:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 212:rtos/uCOS-III/Source/os_sem.c ****     }
 213:rtos/uCOS-III/Source/os_sem.c **** #endif
 214:rtos/uCOS-III/Source/os_sem.c **** 
 215:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_INVALID_OS_CALLS_CHK_EN > 0u)
 216:rtos/uCOS-III/Source/os_sem.c ****     if (OSRunning != OS_STATE_OS_RUNNING) {                     /* Is the kernel running?          
 217:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OS_NOT_RUNNING);
 218:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OS_NOT_RUNNING;
 219:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 220:rtos/uCOS-III/Source/os_sem.c ****     }
 221:rtos/uCOS-III/Source/os_sem.c **** #endif
 222:rtos/uCOS-III/Source/os_sem.c **** 
ARM GAS  /tmp/ccmNIA1d.s 			page 8


 223:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 224:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
 225:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_PTR_NULL);
 226:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 227:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 228:rtos/uCOS-III/Source/os_sem.c ****     }
 229:rtos/uCOS-III/Source/os_sem.c **** #endif
 230:rtos/uCOS-III/Source/os_sem.c **** 
 231:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_OBJ_TYPE_CHK_EN > 0u)
 232:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type != OS_OBJ_TYPE_SEM) {                       /* Make sure semaphore was created 
 233:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_TYPE);
 234:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 235:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 236:rtos/uCOS-III/Source/os_sem.c ****     }
 237:rtos/uCOS-III/Source/os_sem.c **** #endif
 238:rtos/uCOS-III/Source/os_sem.c **** 
 239:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 240:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 241:rtos/uCOS-III/Source/os_sem.c ****     nbr_tasks   = 0u;
 242:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {
 243:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_DEL_NO_PEND:                                /* Delete semaphore only if no task
 244:rtos/uCOS-III/Source/os_sem.c ****              if (p_pend_list->HeadPtr == (OS_TCB *)0) {
 245:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 246:rtos/uCOS-III/Source/os_sem.c ****                  OS_SemDbgListRemove(p_sem);
 247:rtos/uCOS-III/Source/os_sem.c ****                  OSSemQty--;
 248:rtos/uCOS-III/Source/os_sem.c **** #endif
 249:rtos/uCOS-III/Source/os_sem.c ****                  OS_TRACE_SEM_DEL(p_sem);
 250:rtos/uCOS-III/Source/os_sem.c ****                  OS_SemClr(p_sem);
 251:rtos/uCOS-III/Source/os_sem.c ****                  CPU_CRITICAL_EXIT();
 252:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 253:rtos/uCOS-III/Source/os_sem.c ****              } else {
 254:rtos/uCOS-III/Source/os_sem.c ****                  CPU_CRITICAL_EXIT();
 255:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 256:rtos/uCOS-III/Source/os_sem.c ****              }
 257:rtos/uCOS-III/Source/os_sem.c ****              break;
 258:rtos/uCOS-III/Source/os_sem.c **** 
 259:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_DEL_ALWAYS:                                 /* Always delete the semaphore     
 260:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 261:rtos/uCOS-III/Source/os_sem.c ****              ts = OS_TS_GET();                                  /* Get local time stamp so all task
 262:rtos/uCOS-III/Source/os_sem.c **** #else
 263:rtos/uCOS-III/Source/os_sem.c ****              ts = 0u;
 264:rtos/uCOS-III/Source/os_sem.c **** #endif
 265:rtos/uCOS-III/Source/os_sem.c ****              while (p_pend_list->HeadPtr != (OS_TCB *)0) {      /* Remove all tasks on the pend lis
 266:rtos/uCOS-III/Source/os_sem.c ****                  p_tcb = p_pend_list->HeadPtr;
 267:rtos/uCOS-III/Source/os_sem.c ****                  OS_PendAbort(p_tcb,
 268:rtos/uCOS-III/Source/os_sem.c ****                               ts,
 269:rtos/uCOS-III/Source/os_sem.c ****                               OS_STATUS_PEND_DEL);
 270:rtos/uCOS-III/Source/os_sem.c ****                  nbr_tasks++;
 271:rtos/uCOS-III/Source/os_sem.c ****              }
 272:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 273:rtos/uCOS-III/Source/os_sem.c ****              OS_SemDbgListRemove(p_sem);
 274:rtos/uCOS-III/Source/os_sem.c ****              OSSemQty--;
 275:rtos/uCOS-III/Source/os_sem.c **** #endif
 276:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_DEL(p_sem);
 277:rtos/uCOS-III/Source/os_sem.c ****              OS_SemClr(p_sem);
 278:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 279:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
ARM GAS  /tmp/ccmNIA1d.s 			page 9


 280:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_NONE;
 281:rtos/uCOS-III/Source/os_sem.c ****              break;
 282:rtos/uCOS-III/Source/os_sem.c **** 
 283:rtos/uCOS-III/Source/os_sem.c ****         default:
 284:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 285:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 286:rtos/uCOS-III/Source/os_sem.c ****              break;
 287:rtos/uCOS-III/Source/os_sem.c ****     }
 288:rtos/uCOS-III/Source/os_sem.c **** 
 289:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_DEL_EXIT(*p_err);
 290:rtos/uCOS-III/Source/os_sem.c **** 
 291:rtos/uCOS-III/Source/os_sem.c ****     return (nbr_tasks);
 292:rtos/uCOS-III/Source/os_sem.c **** }
 293:rtos/uCOS-III/Source/os_sem.c **** #endif
 294:rtos/uCOS-III/Source/os_sem.c **** 
 295:rtos/uCOS-III/Source/os_sem.c **** 
 296:rtos/uCOS-III/Source/os_sem.c **** /*
 297:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 298:rtos/uCOS-III/Source/os_sem.c **** *                                                  PEND ON SEMAPHORE
 299:rtos/uCOS-III/Source/os_sem.c **** *
 300:rtos/uCOS-III/Source/os_sem.c **** * Description: This function waits for a semaphore.
 301:rtos/uCOS-III/Source/os_sem.c **** *
 302:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem         is a pointer to the semaphore
 303:rtos/uCOS-III/Source/os_sem.c **** *
 304:rtos/uCOS-III/Source/os_sem.c **** *              timeout       is an optional timeout period (in clock ticks).  If non-zero, your tas
 305:rtos/uCOS-III/Source/os_sem.c **** *                            resource up to the amount of time (in 'ticks') specified by this argum
 306:rtos/uCOS-III/Source/os_sem.c **** *                            0, however, your task will wait forever at the specified semaphore or,
 307:rtos/uCOS-III/Source/os_sem.c **** *                            becomes available (or the event occurs).
 308:rtos/uCOS-III/Source/os_sem.c **** *
 309:rtos/uCOS-III/Source/os_sem.c **** *              opt           determines whether the user wants to block if the semaphore is availab
 310:rtos/uCOS-III/Source/os_sem.c **** *
 311:rtos/uCOS-III/Source/os_sem.c **** *                                OS_OPT_PEND_BLOCKING
 312:rtos/uCOS-III/Source/os_sem.c **** *                                OS_OPT_PEND_NON_BLOCKING
 313:rtos/uCOS-III/Source/os_sem.c **** *
 314:rtos/uCOS-III/Source/os_sem.c **** *              p_ts          is a pointer to a variable that will receive the timestamp of when the
 315:rtos/uCOS-III/Source/os_sem.c **** *                            or pend aborted or the semaphore deleted.  If you pass a NULL pointer 
 316:rtos/uCOS-III/Source/os_sem.c **** *                            then you will not get the timestamp.  In other words, passing a NULL p
 317:rtos/uCOS-III/Source/os_sem.c **** *                            and indicates that you don't need the timestamp.
 318:rtos/uCOS-III/Source/os_sem.c **** *
 319:rtos/uCOS-III/Source/os_sem.c **** *              p_err         is a pointer to a variable that will contain an error code returned by
 320:rtos/uCOS-III/Source/os_sem.c **** *
 321:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_NONE               The call was successful and your task ow
 322:rtos/uCOS-III/Source/os_sem.c **** *                                                          or, the event you are waiting for occurr
 323:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_DEL            If 'p_sem' was deleted
 324:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_PTR_NULL       If 'p_sem' is a NULL pointer
 325:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OBJ_TYPE           If 'p_sem' is not pointing at a semaphor
 326:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OPT_INVALID        If you specified an invalid value for 'o
 327:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_OS_NOT_RUNNING     If uC/OS-III is not running yet
 328:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_PEND_ABORT         If the pend was aborted by another task
 329:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_PEND_ISR           If you called this function from an ISR 
 330:rtos/uCOS-III/Source/os_sem.c **** *                                                          would lead to a suspension
 331:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_PEND_WOULD_BLOCK   If you specified non-blocking but the se
 332:rtos/uCOS-III/Source/os_sem.c **** *                                                          available
 333:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_SCHED_LOCKED       If you called this function when the sch
 334:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_STATUS_INVALID     Pend status is invalid
 335:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_TIMEOUT            The semaphore was not received within th
 336:rtos/uCOS-III/Source/os_sem.c **** *                                                          timeout
ARM GAS  /tmp/ccmNIA1d.s 			page 10


 337:rtos/uCOS-III/Source/os_sem.c **** *                                OS_ERR_TICK_DISABLED      If kernel ticks are disabled and a timeo
 338:rtos/uCOS-III/Source/os_sem.c **** *
 339:rtos/uCOS-III/Source/os_sem.c **** *
 340:rtos/uCOS-III/Source/os_sem.c **** * Returns    : The current value of the semaphore counter or 0 if not available.
 341:rtos/uCOS-III/Source/os_sem.c **** *
 342:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : This API 'MUST NOT' be called from a timer callback function.
 343:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 344:rtos/uCOS-III/Source/os_sem.c **** */
 345:rtos/uCOS-III/Source/os_sem.c **** 
 346:rtos/uCOS-III/Source/os_sem.c **** OS_SEM_CTR  OSSemPend (OS_SEM   *p_sem,
 347:rtos/uCOS-III/Source/os_sem.c ****                        OS_TICK   timeout,
 348:rtos/uCOS-III/Source/os_sem.c ****                        OS_OPT    opt,
 349:rtos/uCOS-III/Source/os_sem.c ****                        CPU_TS   *p_ts,
 350:rtos/uCOS-III/Source/os_sem.c ****                        OS_ERR   *p_err)
 351:rtos/uCOS-III/Source/os_sem.c **** {
 165              		.loc 1 351 1 view -0
 166              		.cfi_startproc
 167              		@ args = 4, pretend = 0, frame = 0
 168              		@ frame_needed = 0, uses_anonymous_args = 0
 169              		.loc 1 351 1 is_stmt 0 view .LVU52
 170 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 171              	.LCFI1:
 172              		.cfi_def_cfa_offset 24
 173              		.cfi_offset 4, -24
 174              		.cfi_offset 5, -20
 175              		.cfi_offset 6, -16
 176              		.cfi_offset 7, -12
 177              		.cfi_offset 8, -8
 178              		.cfi_offset 14, -4
 179 0004 0746     		mov	r7, r0
 180 0006 0E46     		mov	r6, r1
 181 0008 1446     		mov	r4, r2
 352:rtos/uCOS-III/Source/os_sem.c ****     OS_SEM_CTR  ctr;
 182              		.loc 1 352 5 is_stmt 1 view .LVU53
 353:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 183              		.loc 1 353 5 view .LVU54
 184              	.LVL17:
 354:rtos/uCOS-III/Source/os_sem.c **** 
 355:rtos/uCOS-III/Source/os_sem.c **** 
 356:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN == 0u)
 357:rtos/uCOS-III/Source/os_sem.c ****     (void)p_ts;                                                /* Prevent compiler warning for not 
 185              		.loc 1 357 5 view .LVU55
 358:rtos/uCOS-III/Source/os_sem.c **** #endif
 359:rtos/uCOS-III/Source/os_sem.c **** 
 360:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
 361:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
 362:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
 363:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 364:rtos/uCOS-III/Source/os_sem.c ****     }
 365:rtos/uCOS-III/Source/os_sem.c **** #endif
 366:rtos/uCOS-III/Source/os_sem.c **** 
 367:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_ENTER(p_sem, timeout, opt, p_ts);
 186              		.loc 1 367 55 view .LVU56
 368:rtos/uCOS-III/Source/os_sem.c **** 
 369:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TICK_EN == 0u)
 370:rtos/uCOS-III/Source/os_sem.c ****     if (timeout != 0u) {
 371:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_TICK_DISABLED;
ARM GAS  /tmp/ccmNIA1d.s 			page 11


 372:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 373:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_TICK_DISABLED);
 374:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 375:rtos/uCOS-III/Source/os_sem.c ****     }
 376:rtos/uCOS-III/Source/os_sem.c **** #endif
 377:rtos/uCOS-III/Source/os_sem.c **** 
 378:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_CALLED_FROM_ISR_CHK_EN > 0u)
 379:rtos/uCOS-III/Source/os_sem.c ****     if (OSIntNestingCtr > 0u) {                                 /* Not allowed to call from an ISR 
 187              		.loc 1 379 5 view .LVU57
 188              		.loc 1 379 25 is_stmt 0 view .LVU58
 189 000a 454B     		ldr	r3, .L35
 190              	.LVL18:
 191              		.loc 1 379 25 view .LVU59
 192 000c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 193              		.loc 1 379 8 view .LVU60
 194 000e 13B1     		cbz	r3, .L13
 380:rtos/uCOS-III/Source/os_sem.c ****         if ((opt & OS_OPT_PEND_NON_BLOCKING) != OS_OPT_PEND_NON_BLOCKING) {
 195              		.loc 1 380 9 is_stmt 1 view .LVU61
 196              		.loc 1 380 12 is_stmt 0 view .LVU62
 197 0010 12F4004F 		tst	r2, #32768
 198 0014 0BD0     		beq	.L30
 199              	.L13:
 381:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 382:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_EXIT(OS_ERR_PEND_ISR);
 383:rtos/uCOS-III/Source/os_sem.c ****            *p_err = OS_ERR_PEND_ISR;
 384:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 385:rtos/uCOS-III/Source/os_sem.c ****         }
 386:rtos/uCOS-III/Source/os_sem.c ****     }
 387:rtos/uCOS-III/Source/os_sem.c **** #endif
 388:rtos/uCOS-III/Source/os_sem.c **** 
 389:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_INVALID_OS_CALLS_CHK_EN > 0u)
 390:rtos/uCOS-III/Source/os_sem.c ****     if (OSRunning != OS_STATE_OS_RUNNING) {                     /* Is the kernel running?          
 200              		.loc 1 390 5 is_stmt 1 view .LVU63
 201              		.loc 1 390 19 is_stmt 0 view .LVU64
 202 0016 434B     		ldr	r3, .L35+4
 203 0018 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 204              		.loc 1 390 8 view .LVU65
 205 001a 012B     		cmp	r3, #1
 206 001c 0DD0     		beq	.L15
 391:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OS_NOT_RUNNING);
 207              		.loc 1 391 54 is_stmt 1 view .LVU66
 392:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OS_NOT_RUNNING;
 208              		.loc 1 392 8 view .LVU67
 209              		.loc 1 392 15 is_stmt 0 view .LVU68
 210 001e 45F68963 		movw	r3, #24201
 211 0022 069A     		ldr	r2, [sp, #24]
 212              	.LVL19:
 213              		.loc 1 392 15 view .LVU69
 214 0024 1380     		strh	r3, [r2]	@ movhi
 393:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 215              		.loc 1 393 9 is_stmt 1 view .LVU70
 216              		.loc 1 393 16 is_stmt 0 view .LVU71
 217 0026 0025     		movs	r5, #0
 218              	.LVL20:
 219              	.L12:
 394:rtos/uCOS-III/Source/os_sem.c ****     }
 395:rtos/uCOS-III/Source/os_sem.c **** #endif
ARM GAS  /tmp/ccmNIA1d.s 			page 12


 396:rtos/uCOS-III/Source/os_sem.c **** 
 397:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 398:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
 399:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OBJ_PTR_NULL);
 400:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 401:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 402:rtos/uCOS-III/Source/os_sem.c ****     }
 403:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {                                              /* Validate 'opt'                  
 404:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_BLOCKING:
 405:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_NON_BLOCKING:
 406:rtos/uCOS-III/Source/os_sem.c ****              break;
 407:rtos/uCOS-III/Source/os_sem.c **** 
 408:rtos/uCOS-III/Source/os_sem.c ****         default:
 409:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_FAILED(p_sem);
 410:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(OS_ERR_OPT_INVALID);
 411:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 412:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 413:rtos/uCOS-III/Source/os_sem.c ****     }
 414:rtos/uCOS-III/Source/os_sem.c **** #endif
 415:rtos/uCOS-III/Source/os_sem.c **** 
 416:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_OBJ_TYPE_CHK_EN > 0u)
 417:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type != OS_OBJ_TYPE_SEM) {                       /* Make sure semaphore was created 
 418:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 419:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OBJ_TYPE);
 420:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 421:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 422:rtos/uCOS-III/Source/os_sem.c ****     }
 423:rtos/uCOS-III/Source/os_sem.c **** #endif
 424:rtos/uCOS-III/Source/os_sem.c **** 
 425:rtos/uCOS-III/Source/os_sem.c **** 
 426:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 427:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 428:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr--;                                           /* Yes, caller may proceed         
 429:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 430:rtos/uCOS-III/Source/os_sem.c ****         if (p_ts != (CPU_TS *)0) {
 431:rtos/uCOS-III/Source/os_sem.c ****            *p_ts = p_sem->TS;                                   /* get timestamp of last post      
 432:rtos/uCOS-III/Source/os_sem.c ****         }
 433:rtos/uCOS-III/Source/os_sem.c **** #endif
 434:rtos/uCOS-III/Source/os_sem.c ****         ctr   = p_sem->Ctr;
 435:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND(p_sem);
 436:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 437:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 438:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_NONE;
 439:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 440:rtos/uCOS-III/Source/os_sem.c ****     }
 441:rtos/uCOS-III/Source/os_sem.c **** 
 442:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_PEND_NON_BLOCKING) != 0u) {               /* Caller wants to block if not ava
 443:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 444:rtos/uCOS-III/Source/os_sem.c ****         if (p_ts != (CPU_TS *)0) {
 445:rtos/uCOS-III/Source/os_sem.c ****            *p_ts = 0u;
 446:rtos/uCOS-III/Source/os_sem.c ****         }
 447:rtos/uCOS-III/Source/os_sem.c **** #endif
 448:rtos/uCOS-III/Source/os_sem.c ****         ctr   = p_sem->Ctr;                                     /* No                              
 449:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 450:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 451:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_PEND_WOULD_BLOCK);
 452:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_PEND_WOULD_BLOCK;
ARM GAS  /tmp/ccmNIA1d.s 			page 13


 453:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 454:rtos/uCOS-III/Source/os_sem.c ****     } else {                                                    /* Yes                             
 455:rtos/uCOS-III/Source/os_sem.c ****         if (OSSchedLockNestingCtr > 0u) {                       /* Can't pend when the scheduler is
 456:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 457:rtos/uCOS-III/Source/os_sem.c ****             if (p_ts != (CPU_TS *)0) {
 458:rtos/uCOS-III/Source/os_sem.c ****                *p_ts = 0u;
 459:rtos/uCOS-III/Source/os_sem.c ****             }
 460:rtos/uCOS-III/Source/os_sem.c **** #endif
 461:rtos/uCOS-III/Source/os_sem.c ****             CPU_CRITICAL_EXIT();
 462:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 463:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_EXIT(OS_ERR_SCHED_LOCKED);
 464:rtos/uCOS-III/Source/os_sem.c ****            *p_err = OS_ERR_SCHED_LOCKED;
 465:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 466:rtos/uCOS-III/Source/os_sem.c ****         }
 467:rtos/uCOS-III/Source/os_sem.c ****     }
 468:rtos/uCOS-III/Source/os_sem.c **** 
 469:rtos/uCOS-III/Source/os_sem.c ****     OS_Pend((OS_PEND_OBJ *)((void *)p_sem),                     /* Block task pending on Semaphore 
 470:rtos/uCOS-III/Source/os_sem.c ****             OSTCBCurPtr,
 471:rtos/uCOS-III/Source/os_sem.c ****             OS_TASK_PEND_ON_SEM,
 472:rtos/uCOS-III/Source/os_sem.c ****             timeout);
 473:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 474:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 475:rtos/uCOS-III/Source/os_sem.c ****     OSSched();                                                  /* Find the next highest priority t
 476:rtos/uCOS-III/Source/os_sem.c **** 
 477:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 478:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 479:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_OK:                                 /* We got the semaphore            
 480:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 481:rtos/uCOS-III/Source/os_sem.c ****              if (p_ts != (CPU_TS *)0) {
 482:rtos/uCOS-III/Source/os_sem.c ****                 *p_ts = OSTCBCurPtr->TS;
 483:rtos/uCOS-III/Source/os_sem.c ****              }
 484:rtos/uCOS-III/Source/os_sem.c **** #endif
 485:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND(p_sem);
 486:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_NONE;
 487:rtos/uCOS-III/Source/os_sem.c ****              break;
 488:rtos/uCOS-III/Source/os_sem.c **** 
 489:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_ABORT:                              /* Indicate that we aborted        
 490:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 491:rtos/uCOS-III/Source/os_sem.c ****              if (p_ts != (CPU_TS *)0) {
 492:rtos/uCOS-III/Source/os_sem.c ****                 *p_ts = OSTCBCurPtr->TS;
 493:rtos/uCOS-III/Source/os_sem.c ****              }
 494:rtos/uCOS-III/Source/os_sem.c **** #endif
 495:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_FAILED(p_sem);
 496:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_PEND_ABORT;
 497:rtos/uCOS-III/Source/os_sem.c ****              break;
 498:rtos/uCOS-III/Source/os_sem.c **** 
 499:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_TIMEOUT:                            /* Indicate that we didn't get sema
 500:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 501:rtos/uCOS-III/Source/os_sem.c ****              if (p_ts != (CPU_TS *)0) {
 502:rtos/uCOS-III/Source/os_sem.c ****                 *p_ts = 0u;
 503:rtos/uCOS-III/Source/os_sem.c ****              }
 504:rtos/uCOS-III/Source/os_sem.c **** #endif
 505:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_FAILED(p_sem);
 506:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_TIMEOUT;
 507:rtos/uCOS-III/Source/os_sem.c ****              break;
 508:rtos/uCOS-III/Source/os_sem.c **** 
 509:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_DEL:                                /* Indicate that object pended on h
ARM GAS  /tmp/ccmNIA1d.s 			page 14


 510:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 511:rtos/uCOS-III/Source/os_sem.c ****              if (p_ts != (CPU_TS *)0) {
 512:rtos/uCOS-III/Source/os_sem.c ****                 *p_ts = OSTCBCurPtr->TS;
 513:rtos/uCOS-III/Source/os_sem.c ****              }
 514:rtos/uCOS-III/Source/os_sem.c **** #endif
 515:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_FAILED(p_sem);
 516:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OBJ_DEL;
 517:rtos/uCOS-III/Source/os_sem.c ****              break;
 518:rtos/uCOS-III/Source/os_sem.c **** 
 519:rtos/uCOS-III/Source/os_sem.c ****         default:
 520:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_FAILED(p_sem);
 521:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_STATUS_INVALID;
 522:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 523:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 524:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 525:rtos/uCOS-III/Source/os_sem.c ****     }
 526:rtos/uCOS-III/Source/os_sem.c ****     ctr = p_sem->Ctr;
 527:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 528:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 529:rtos/uCOS-III/Source/os_sem.c ****     return (ctr);
 530:rtos/uCOS-III/Source/os_sem.c **** }
 220              		.loc 1 530 1 view .LVU72
 221 0028 2846     		mov	r0, r5
 222 002a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 223              	.LVL21:
 224              	.L30:
 381:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_EXIT(OS_ERR_PEND_ISR);
 225              		.loc 1 381 44 is_stmt 1 view .LVU73
 382:rtos/uCOS-III/Source/os_sem.c ****            *p_err = OS_ERR_PEND_ISR;
 226              		.loc 1 382 52 view .LVU74
 383:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 227              		.loc 1 383 12 view .LVU75
 383:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 228              		.loc 1 383 19 is_stmt 0 view .LVU76
 229 002e 46F2AE13 		movw	r3, #25006
 230 0032 069A     		ldr	r2, [sp, #24]
 231              	.LVL22:
 383:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 232              		.loc 1 383 19 view .LVU77
 233 0034 1380     		strh	r3, [r2]	@ movhi
 384:rtos/uCOS-III/Source/os_sem.c ****         }
 234              		.loc 1 384 13 is_stmt 1 view .LVU78
 384:rtos/uCOS-III/Source/os_sem.c ****         }
 235              		.loc 1 384 20 is_stmt 0 view .LVU79
 236 0036 0025     		movs	r5, #0
 237 0038 F6E7     		b	.L12
 238              	.LVL23:
 239              	.L15:
 398:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OBJ_PTR_NULL);
 240              		.loc 1 398 5 is_stmt 1 view .LVU80
 398:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OBJ_PTR_NULL);
 241              		.loc 1 398 8 is_stmt 0 view .LVU81
 242 003a 4FB1     		cbz	r7, .L31
 403:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_BLOCKING:
 243              		.loc 1 403 5 is_stmt 1 view .LVU82
 244 003c 74B1     		cbz	r4, .L17
 245 003e B4F5004F 		cmp	r4, #32768
ARM GAS  /tmp/ccmNIA1d.s 			page 15


 246 0042 0BD0     		beq	.L17
 409:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(OS_ERR_OPT_INVALID);
 247              		.loc 1 409 45 view .LVU83
 410:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 248              		.loc 1 410 56 view .LVU84
 411:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 249              		.loc 1 411 13 view .LVU85
 411:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 250              		.loc 1 411 20 is_stmt 0 view .LVU86
 251 0044 45F62563 		movw	r3, #24101
 252 0048 069A     		ldr	r2, [sp, #24]
 253              	.LVL24:
 411:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 254              		.loc 1 411 20 view .LVU87
 255 004a 1380     		strh	r3, [r2]	@ movhi
 412:rtos/uCOS-III/Source/os_sem.c ****     }
 256              		.loc 1 412 14 is_stmt 1 view .LVU88
 412:rtos/uCOS-III/Source/os_sem.c ****     }
 257              		.loc 1 412 21 is_stmt 0 view .LVU89
 258 004c 0025     		movs	r5, #0
 259 004e EBE7     		b	.L12
 260              	.LVL25:
 261              	.L31:
 399:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 262              		.loc 1 399 52 is_stmt 1 view .LVU90
 400:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 263              		.loc 1 400 8 view .LVU91
 400:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 264              		.loc 1 400 15 is_stmt 0 view .LVU92
 265 0050 45F6C353 		movw	r3, #24003
 266 0054 069A     		ldr	r2, [sp, #24]
 267              	.LVL26:
 400:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 268              		.loc 1 400 15 view .LVU93
 269 0056 1380     		strh	r3, [r2]	@ movhi
 401:rtos/uCOS-III/Source/os_sem.c ****     }
 270              		.loc 1 401 9 is_stmt 1 view .LVU94
 401:rtos/uCOS-III/Source/os_sem.c ****     }
 271              		.loc 1 401 16 is_stmt 0 view .LVU95
 272 0058 0025     		movs	r5, #0
 273 005a E5E7     		b	.L12
 274              	.LVL27:
 275              	.L17:
 406:rtos/uCOS-III/Source/os_sem.c **** 
 276              		.loc 1 406 14 is_stmt 1 view .LVU96
 417:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 277              		.loc 1 417 5 view .LVU97
 417:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 278              		.loc 1 417 14 is_stmt 0 view .LVU98
 279 005c 3A68     		ldr	r2, [r7]
 280              	.LVL28:
 417:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 281              		.loc 1 417 8 view .LVU99
 282 005e 324B     		ldr	r3, .L35+8
 283 0060 9A42     		cmp	r2, r3
 284 0062 05D0     		beq	.L18
 418:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_OBJ_TYPE);
ARM GAS  /tmp/ccmNIA1d.s 			page 16


 285              		.loc 1 418 40 is_stmt 1 view .LVU100
 419:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 286              		.loc 1 419 48 view .LVU101
 420:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 287              		.loc 1 420 8 view .LVU102
 420:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 288              		.loc 1 420 15 is_stmt 0 view .LVU103
 289 0064 45F6C453 		movw	r3, #24004
 290 0068 069A     		ldr	r2, [sp, #24]
 291 006a 1380     		strh	r3, [r2]	@ movhi
 421:rtos/uCOS-III/Source/os_sem.c ****     }
 292              		.loc 1 421 9 is_stmt 1 view .LVU104
 421:rtos/uCOS-III/Source/os_sem.c ****     }
 293              		.loc 1 421 16 is_stmt 0 view .LVU105
 294 006c 0025     		movs	r5, #0
 295 006e DBE7     		b	.L12
 296              	.L18:
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 297              		.loc 1 426 5 is_stmt 1 view .LVU106
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 298              		.loc 1 426 5 view .LVU107
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 299              		.loc 1 426 5 view .LVU108
 300 0070 4020     		movs	r0, #64
 301              	.LVL29:
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 302              		.loc 1 426 5 is_stmt 0 view .LVU109
 303 0072 FFF7FEFF 		bl	CPU_SR_Save
 304              	.LVL30:
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 305              		.loc 1 426 5 view .LVU110
 306 0076 8046     		mov	r8, r0
 307              	.LVL31:
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 308              		.loc 1 426 5 is_stmt 1 view .LVU111
 426:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* Resource available?             
 309              		.loc 1 426 5 view .LVU112
 427:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr--;                                           /* Yes, caller may proceed         
 310              		.loc 1 427 5 view .LVU113
 427:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr--;                                           /* Yes, caller may proceed         
 311              		.loc 1 427 14 is_stmt 0 view .LVU114
 312 0078 FD68     		ldr	r5, [r7, #12]
 427:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr--;                                           /* Yes, caller may proceed         
 313              		.loc 1 427 8 view .LVU115
 314 007a EDB9     		cbnz	r5, .L32
 442:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 315              		.loc 1 442 5 is_stmt 1 view .LVU116
 442:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 316              		.loc 1 442 8 is_stmt 0 view .LVU117
 317 007c 14F4004F 		tst	r4, #32768
 318 0080 22D1     		bne	.L33
 455:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 319              		.loc 1 455 9 is_stmt 1 view .LVU118
 455:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 320              		.loc 1 455 35 is_stmt 0 view .LVU119
 321 0082 2A4B     		ldr	r3, .L35+12
 322 0084 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
ARM GAS  /tmp/ccmNIA1d.s 			page 17


 455:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 323              		.loc 1 455 12 view .LVU120
 324 0086 33BB     		cbnz	r3, .L34
 469:rtos/uCOS-III/Source/os_sem.c ****             OSTCBCurPtr,
 325              		.loc 1 469 5 is_stmt 1 view .LVU121
 326 0088 294C     		ldr	r4, .L35+16
 327 008a 3346     		mov	r3, r6
 328 008c 0622     		movs	r2, #6
 329 008e 2168     		ldr	r1, [r4]
 330 0090 3846     		mov	r0, r7
 331              	.LVL32:
 469:rtos/uCOS-III/Source/os_sem.c ****             OSTCBCurPtr,
 332              		.loc 1 469 5 is_stmt 0 view .LVU122
 333 0092 FFF7FEFF 		bl	OS_Pend
 334              	.LVL33:
 473:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 335              		.loc 1 473 5 is_stmt 1 view .LVU123
 473:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 336              		.loc 1 473 5 view .LVU124
 473:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 337              		.loc 1 473 5 view .LVU125
 338 0096 4046     		mov	r0, r8
 339 0098 FFF7FEFF 		bl	CPU_SR_Restore
 340              	.LVL34:
 473:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 341              		.loc 1 473 5 view .LVU126
 473:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_BLOCK(p_sem);
 342              		.loc 1 473 5 view .LVU127
 474:rtos/uCOS-III/Source/os_sem.c ****     OSSched();                                                  /* Find the next highest priority t
 343              		.loc 1 474 35 view .LVU128
 475:rtos/uCOS-III/Source/os_sem.c **** 
 344              		.loc 1 475 5 view .LVU129
 345 009c FFF7FEFF 		bl	OSSched
 346              	.LVL35:
 477:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 347              		.loc 1 477 5 view .LVU130
 477:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 348              		.loc 1 477 5 view .LVU131
 477:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 349              		.loc 1 477 5 view .LVU132
 350 00a0 4020     		movs	r0, #64
 351 00a2 FFF7FEFF 		bl	CPU_SR_Save
 352              	.LVL36:
 477:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 353              		.loc 1 477 5 view .LVU133
 477:rtos/uCOS-III/Source/os_sem.c ****     switch (OSTCBCurPtr->PendStatus) {
 354              		.loc 1 477 5 view .LVU134
 478:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_OK:                                 /* We got the semaphore            
 355              		.loc 1 478 5 view .LVU135
 478:rtos/uCOS-III/Source/os_sem.c ****         case OS_STATUS_PEND_OK:                                 /* We got the semaphore            
 356              		.loc 1 478 24 is_stmt 0 view .LVU136
 357 00a6 2368     		ldr	r3, [r4]
 358 00a8 93F82D30 		ldrb	r3, [r3, #45]	@ zero_extendqisi2
 359 00ac 032B     		cmp	r3, #3
 360 00ae 2FD8     		bhi	.L22
 361 00b0 DFE803F0 		tbb	[pc, r3]
 362              	.L24:
ARM GAS  /tmp/ccmNIA1d.s 			page 18


 363 00b4 18       		.byte	(.L27-.L24)/2
 364 00b5 1F       		.byte	(.L26-.L24)/2
 365 00b6 29       		.byte	(.L25-.L24)/2
 366 00b7 24       		.byte	(.L23-.L24)/2
 367              		.p2align 1
 368              	.L32:
 428:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 369              		.loc 1 428 9 is_stmt 1 view .LVU137
 428:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 370              		.loc 1 428 19 is_stmt 0 view .LVU138
 371 00b8 013D     		subs	r5, r5, #1
 372 00ba FD60     		str	r5, [r7, #12]
 434:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND(p_sem);
 373              		.loc 1 434 9 is_stmt 1 view .LVU139
 374              	.LVL37:
 435:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 375              		.loc 1 435 33 view .LVU140
 436:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 376              		.loc 1 436 9 view .LVU141
 436:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 377              		.loc 1 436 9 view .LVU142
 436:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 378              		.loc 1 436 9 view .LVU143
 379 00bc FFF7FEFF 		bl	CPU_SR_Restore
 380              	.LVL38:
 436:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 381              		.loc 1 436 9 view .LVU144
 436:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_NONE);
 382              		.loc 1 436 9 view .LVU145
 437:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_NONE;
 383              		.loc 1 437 44 view .LVU146
 438:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 384              		.loc 1 438 8 view .LVU147
 438:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 385              		.loc 1 438 15 is_stmt 0 view .LVU148
 386 00c0 0023     		movs	r3, #0
 387 00c2 069A     		ldr	r2, [sp, #24]
 388 00c4 1380     		strh	r3, [r2]	@ movhi
 439:rtos/uCOS-III/Source/os_sem.c ****     }
 389              		.loc 1 439 9 is_stmt 1 view .LVU149
 439:rtos/uCOS-III/Source/os_sem.c ****     }
 390              		.loc 1 439 16 is_stmt 0 view .LVU150
 391 00c6 AFE7     		b	.L12
 392              	.LVL39:
 393              	.L33:
 448:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 394              		.loc 1 448 9 is_stmt 1 view .LVU151
 449:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 395              		.loc 1 449 9 view .LVU152
 449:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 396              		.loc 1 449 9 view .LVU153
 449:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 397              		.loc 1 449 9 view .LVU154
 398 00c8 FFF7FEFF 		bl	CPU_SR_Restore
 399              	.LVL40:
 449:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 400              		.loc 1 449 9 view .LVU155
ARM GAS  /tmp/ccmNIA1d.s 			page 19


 449:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_FAILED(p_sem);
 401              		.loc 1 449 9 view .LVU156
 450:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_PEND_EXIT(OS_ERR_PEND_WOULD_BLOCK);
 402              		.loc 1 450 40 view .LVU157
 451:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_PEND_WOULD_BLOCK;
 403              		.loc 1 451 56 view .LVU158
 452:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 404              		.loc 1 452 8 view .LVU159
 452:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 405              		.loc 1 452 15 is_stmt 0 view .LVU160
 406 00cc 46F2B013 		movw	r3, #25008
 407 00d0 069A     		ldr	r2, [sp, #24]
 408 00d2 1380     		strh	r3, [r2]	@ movhi
 453:rtos/uCOS-III/Source/os_sem.c ****     } else {                                                    /* Yes                             
 409              		.loc 1 453 9 is_stmt 1 view .LVU161
 453:rtos/uCOS-III/Source/os_sem.c ****     } else {                                                    /* Yes                             
 410              		.loc 1 453 16 is_stmt 0 view .LVU162
 411 00d4 A8E7     		b	.L12
 412              	.LVL41:
 413              	.L34:
 461:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 414              		.loc 1 461 13 is_stmt 1 view .LVU163
 461:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 415              		.loc 1 461 13 view .LVU164
 461:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 416              		.loc 1 461 13 view .LVU165
 417 00d6 FFF7FEFF 		bl	CPU_SR_Restore
 418              	.LVL42:
 461:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 419              		.loc 1 461 13 view .LVU166
 461:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_FAILED(p_sem);
 420              		.loc 1 461 13 view .LVU167
 462:rtos/uCOS-III/Source/os_sem.c ****             OS_TRACE_SEM_PEND_EXIT(OS_ERR_SCHED_LOCKED);
 421              		.loc 1 462 44 view .LVU168
 463:rtos/uCOS-III/Source/os_sem.c ****            *p_err = OS_ERR_SCHED_LOCKED;
 422              		.loc 1 463 56 view .LVU169
 464:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 423              		.loc 1 464 12 view .LVU170
 464:rtos/uCOS-III/Source/os_sem.c ****             return (0u);
 424              		.loc 1 464 19 is_stmt 0 view .LVU171
 425 00da 46F66353 		movw	r3, #28003
 426 00de 069A     		ldr	r2, [sp, #24]
 427 00e0 1380     		strh	r3, [r2]	@ movhi
 465:rtos/uCOS-III/Source/os_sem.c ****         }
 428              		.loc 1 465 13 is_stmt 1 view .LVU172
 465:rtos/uCOS-III/Source/os_sem.c ****         }
 429              		.loc 1 465 20 is_stmt 0 view .LVU173
 430 00e2 A1E7     		b	.L12
 431              	.LVL43:
 432              	.L27:
 485:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_NONE;
 433              		.loc 1 485 38 is_stmt 1 view .LVU174
 486:rtos/uCOS-III/Source/os_sem.c ****              break;
 434              		.loc 1 486 13 view .LVU175
 486:rtos/uCOS-III/Source/os_sem.c ****              break;
 435              		.loc 1 486 20 is_stmt 0 view .LVU176
 436 00e4 0023     		movs	r3, #0
ARM GAS  /tmp/ccmNIA1d.s 			page 20


 437 00e6 069A     		ldr	r2, [sp, #24]
 438 00e8 1380     		strh	r3, [r2]	@ movhi
 487:rtos/uCOS-III/Source/os_sem.c **** 
 439              		.loc 1 487 14 is_stmt 1 view .LVU177
 440              	.L28:
 526:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 441              		.loc 1 526 5 view .LVU178
 526:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 442              		.loc 1 526 9 is_stmt 0 view .LVU179
 443 00ea FD68     		ldr	r5, [r7, #12]
 444              	.LVL44:
 527:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 445              		.loc 1 527 5 is_stmt 1 view .LVU180
 527:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 446              		.loc 1 527 5 view .LVU181
 527:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 447              		.loc 1 527 5 view .LVU182
 448 00ec FFF7FEFF 		bl	CPU_SR_Restore
 449              	.LVL45:
 527:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 450              		.loc 1 527 5 view .LVU183
 527:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_PEND_EXIT(*p_err);
 451              		.loc 1 527 5 view .LVU184
 528:rtos/uCOS-III/Source/os_sem.c ****     return (ctr);
 452              		.loc 1 528 35 view .LVU185
 529:rtos/uCOS-III/Source/os_sem.c **** }
 453              		.loc 1 529 5 view .LVU186
 529:rtos/uCOS-III/Source/os_sem.c **** }
 454              		.loc 1 529 12 is_stmt 0 view .LVU187
 455 00f0 9AE7     		b	.L12
 456              	.LVL46:
 457              	.L26:
 495:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_PEND_ABORT;
 458              		.loc 1 495 45 is_stmt 1 view .LVU188
 496:rtos/uCOS-III/Source/os_sem.c ****              break;
 459              		.loc 1 496 13 view .LVU189
 496:rtos/uCOS-III/Source/os_sem.c ****              break;
 460              		.loc 1 496 20 is_stmt 0 view .LVU190
 461 00f2 46F2A913 		movw	r3, #25001
 462 00f6 069A     		ldr	r2, [sp, #24]
 463 00f8 1380     		strh	r3, [r2]	@ movhi
 497:rtos/uCOS-III/Source/os_sem.c **** 
 464              		.loc 1 497 14 is_stmt 1 view .LVU191
 465 00fa F6E7     		b	.L28
 466              	.L23:
 505:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_TIMEOUT;
 467              		.loc 1 505 45 view .LVU192
 506:rtos/uCOS-III/Source/os_sem.c ****              break;
 468              		.loc 1 506 13 view .LVU193
 506:rtos/uCOS-III/Source/os_sem.c ****              break;
 469              		.loc 1 506 20 is_stmt 0 view .LVU194
 470 00fc 47F2D923 		movw	r3, #29401
 471 0100 069A     		ldr	r2, [sp, #24]
 472 0102 1380     		strh	r3, [r2]	@ movhi
 507:rtos/uCOS-III/Source/os_sem.c **** 
 473              		.loc 1 507 14 is_stmt 1 view .LVU195
 474 0104 F1E7     		b	.L28
ARM GAS  /tmp/ccmNIA1d.s 			page 21


 475              	.L25:
 515:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OBJ_DEL;
 476              		.loc 1 515 45 view .LVU196
 516:rtos/uCOS-III/Source/os_sem.c ****              break;
 477              		.loc 1 516 13 view .LVU197
 516:rtos/uCOS-III/Source/os_sem.c ****              break;
 478              		.loc 1 516 20 is_stmt 0 view .LVU198
 479 0106 45F6C253 		movw	r3, #24002
 480 010a 069A     		ldr	r2, [sp, #24]
 481 010c 1380     		strh	r3, [r2]	@ movhi
 517:rtos/uCOS-III/Source/os_sem.c **** 
 482              		.loc 1 517 14 is_stmt 1 view .LVU199
 483 010e ECE7     		b	.L28
 484              	.L22:
 520:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_STATUS_INVALID;
 485              		.loc 1 520 45 view .LVU200
 521:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 486              		.loc 1 521 13 view .LVU201
 521:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 487              		.loc 1 521 20 is_stmt 0 view .LVU202
 488 0110 46F62E63 		movw	r3, #28206
 489 0114 069A     		ldr	r2, [sp, #24]
 490 0116 1380     		strh	r3, [r2]	@ movhi
 522:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 491              		.loc 1 522 14 is_stmt 1 view .LVU203
 522:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 492              		.loc 1 522 14 view .LVU204
 522:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 493              		.loc 1 522 14 view .LVU205
 494 0118 FFF7FEFF 		bl	CPU_SR_Restore
 495              	.LVL47:
 522:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 496              		.loc 1 522 14 view .LVU206
 522:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_PEND_EXIT(*p_err);
 497              		.loc 1 522 14 view .LVU207
 523:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 498              		.loc 1 523 44 view .LVU208
 524:rtos/uCOS-III/Source/os_sem.c ****     }
 499              		.loc 1 524 14 view .LVU209
 524:rtos/uCOS-III/Source/os_sem.c ****     }
 500              		.loc 1 524 21 is_stmt 0 view .LVU210
 501 011c 84E7     		b	.L12
 502              	.L36:
 503 011e 00BF     		.align	2
 504              	.L35:
 505 0120 00000000 		.word	OSIntNestingCtr
 506 0124 00000000 		.word	OSRunning
 507 0128 53454D41 		.word	1095583059
 508 012c 00000000 		.word	OSSchedLockNestingCtr
 509 0130 00000000 		.word	OSTCBCurPtr
 510              		.cfi_endproc
 511              	.LFE2:
 513              		.section	.text.OSSemPendAbort,"ax",%progbits
 514              		.align	1
 515              		.global	OSSemPendAbort
 516              		.syntax unified
 517              		.thumb
ARM GAS  /tmp/ccmNIA1d.s 			page 22


 518              		.thumb_func
 519              		.fpu fpv4-sp-d16
 521              	OSSemPendAbort:
 522              	.LVL48:
 523              	.LFB3:
 531:rtos/uCOS-III/Source/os_sem.c **** 
 532:rtos/uCOS-III/Source/os_sem.c **** 
 533:rtos/uCOS-III/Source/os_sem.c **** /*
 534:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 535:rtos/uCOS-III/Source/os_sem.c **** *                                             ABORT WAITING ON A SEMAPHORE
 536:rtos/uCOS-III/Source/os_sem.c **** *
 537:rtos/uCOS-III/Source/os_sem.c **** * Description: This function aborts & readies any tasks currently waiting on a semaphore.  This fun
 538:rtos/uCOS-III/Source/os_sem.c **** *              to fault-abort the wait on the semaphore, rather than to normally signal the semapho
 539:rtos/uCOS-III/Source/os_sem.c **** *
 540:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem     is a pointer to the semaphore
 541:rtos/uCOS-III/Source/os_sem.c **** *
 542:rtos/uCOS-III/Source/os_sem.c **** *              opt       determines the type of ABORT performed:
 543:rtos/uCOS-III/Source/os_sem.c **** *
 544:rtos/uCOS-III/Source/os_sem.c **** *                            OS_OPT_PEND_ABORT_1          ABORT wait for a single task (HPT) waitin
 545:rtos/uCOS-III/Source/os_sem.c **** *                            OS_OPT_PEND_ABORT_ALL        ABORT wait for ALL tasks that are  waitin
 546:rtos/uCOS-III/Source/os_sem.c **** *                            OS_OPT_POST_NO_SCHED         Do not call the scheduler
 547:rtos/uCOS-III/Source/os_sem.c **** *
 548:rtos/uCOS-III/Source/os_sem.c **** *              p_err     is a pointer to a variable that will contain an error code returned by thi
 549:rtos/uCOS-III/Source/os_sem.c **** *
 550:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_NONE                  At least one task waiting on the semaphor
 551:rtos/uCOS-III/Source/os_sem.c **** *                                                         informed of the aborted wait; check retur
 552:rtos/uCOS-III/Source/os_sem.c **** *                                                         number of tasks whose wait on the semapho
 553:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OBJ_PTR_NULL          If 'p_sem' is a NULL pointer.
 554:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OBJ_TYPE              If 'p_sem' is not pointing at a semaphore
 555:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OPT_INVALID           If you specified an invalid option
 556:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OS_NOT_RUNNING        If uC/OS-III is not running yet
 557:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_PEND_ABORT_ISR        If you called this function from an ISR
 558:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_PEND_ABORT_NONE       No task were pending
 559:rtos/uCOS-III/Source/os_sem.c **** *
 560:rtos/uCOS-III/Source/os_sem.c **** * Returns    : == 0          if no tasks were waiting on the semaphore, or upon error.
 561:rtos/uCOS-III/Source/os_sem.c **** *              >  0          if one or more tasks waiting on the semaphore are now readied and info
 562:rtos/uCOS-III/Source/os_sem.c **** *
 563:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : none
 564:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 565:rtos/uCOS-III/Source/os_sem.c **** */
 566:rtos/uCOS-III/Source/os_sem.c **** 
 567:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_SEM_PEND_ABORT_EN > 0u)
 568:rtos/uCOS-III/Source/os_sem.c **** OS_OBJ_QTY  OSSemPendAbort (OS_SEM  *p_sem,
 569:rtos/uCOS-III/Source/os_sem.c ****                             OS_OPT   opt,
 570:rtos/uCOS-III/Source/os_sem.c ****                             OS_ERR  *p_err)
 571:rtos/uCOS-III/Source/os_sem.c **** {
 524              		.loc 1 571 1 is_stmt 1 view -0
 525              		.cfi_startproc
 526              		@ args = 0, pretend = 0, frame = 0
 527              		@ frame_needed = 0, uses_anonymous_args = 0
 528              		.loc 1 571 1 is_stmt 0 view .LVU212
 529 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 530              	.LCFI2:
 531              		.cfi_def_cfa_offset 24
 532              		.cfi_offset 4, -24
 533              		.cfi_offset 5, -20
 534              		.cfi_offset 6, -16
ARM GAS  /tmp/ccmNIA1d.s 			page 23


 535              		.cfi_offset 7, -12
 536              		.cfi_offset 8, -8
 537              		.cfi_offset 14, -4
 538 0004 1646     		mov	r6, r2
 572:rtos/uCOS-III/Source/os_sem.c ****     OS_PEND_LIST  *p_pend_list;
 539              		.loc 1 572 5 is_stmt 1 view .LVU213
 573:rtos/uCOS-III/Source/os_sem.c ****     OS_TCB        *p_tcb;
 540              		.loc 1 573 5 view .LVU214
 574:rtos/uCOS-III/Source/os_sem.c ****     CPU_TS         ts;
 541              		.loc 1 574 5 view .LVU215
 575:rtos/uCOS-III/Source/os_sem.c ****     OS_OBJ_QTY     nbr_tasks;
 542              		.loc 1 575 5 view .LVU216
 576:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 543              		.loc 1 576 5 view .LVU217
 544              	.LVL49:
 577:rtos/uCOS-III/Source/os_sem.c **** 
 578:rtos/uCOS-III/Source/os_sem.c **** 
 579:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
 580:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
 581:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
 582:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 583:rtos/uCOS-III/Source/os_sem.c ****     }
 584:rtos/uCOS-III/Source/os_sem.c **** #endif
 585:rtos/uCOS-III/Source/os_sem.c **** 
 586:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_CALLED_FROM_ISR_CHK_EN > 0u)
 587:rtos/uCOS-III/Source/os_sem.c ****     if (OSIntNestingCtr > 0u) {                                 /* Not allowed to Pend Abort from a
 545              		.loc 1 587 5 view .LVU218
 546              		.loc 1 587 25 is_stmt 0 view .LVU219
 547 0006 2C4B     		ldr	r3, .L56
 548 0008 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 549              		.loc 1 587 8 view .LVU220
 550 000a 53B9     		cbnz	r3, .L52
 551 000c 0746     		mov	r7, r0
 552 000e 0C46     		mov	r4, r1
 588:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_ISR;
 589:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 590:rtos/uCOS-III/Source/os_sem.c ****     }
 591:rtos/uCOS-III/Source/os_sem.c **** #endif
 592:rtos/uCOS-III/Source/os_sem.c **** 
 593:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_INVALID_OS_CALLS_CHK_EN > 0u)
 594:rtos/uCOS-III/Source/os_sem.c ****     if (OSRunning != OS_STATE_OS_RUNNING) {                     /* Is the kernel running?          
 553              		.loc 1 594 5 is_stmt 1 view .LVU221
 554              		.loc 1 594 19 is_stmt 0 view .LVU222
 555 0010 2A4B     		ldr	r3, .L56+4
 556 0012 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 557              		.loc 1 594 8 view .LVU223
 558 0014 012B     		cmp	r3, #1
 559 0016 0BD0     		beq	.L40
 595:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OS_NOT_RUNNING;
 560              		.loc 1 595 8 is_stmt 1 view .LVU224
 561              		.loc 1 595 15 is_stmt 0 view .LVU225
 562 0018 45F68963 		movw	r3, #24201
 563 001c 1380     		strh	r3, [r2]	@ movhi
 596:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 564              		.loc 1 596 9 is_stmt 1 view .LVU226
 565              		.loc 1 596 16 is_stmt 0 view .LVU227
 566 001e 0025     		movs	r5, #0
ARM GAS  /tmp/ccmNIA1d.s 			page 24


 567 0020 03E0     		b	.L39
 568              	.L52:
 588:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_ISR;
 569              		.loc 1 588 8 is_stmt 1 view .LVU228
 588:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_ISR;
 570              		.loc 1 588 15 is_stmt 0 view .LVU229
 571 0022 46F2AA13 		movw	r3, #25002
 572 0026 1380     		strh	r3, [r2]	@ movhi
 589:rtos/uCOS-III/Source/os_sem.c ****     }
 573              		.loc 1 589 9 is_stmt 1 view .LVU230
 589:rtos/uCOS-III/Source/os_sem.c ****     }
 574              		.loc 1 589 16 is_stmt 0 view .LVU231
 575 0028 0025     		movs	r5, #0
 576              	.LVL50:
 577              	.L39:
 597:rtos/uCOS-III/Source/os_sem.c ****     }
 598:rtos/uCOS-III/Source/os_sem.c **** #endif
 599:rtos/uCOS-III/Source/os_sem.c **** 
 600:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 601:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
 602:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_PTR_NULL;
 603:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 604:rtos/uCOS-III/Source/os_sem.c ****     }
 605:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {                                              /* Validate 'opt'                  
 606:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_1:
 607:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_ALL:
 608:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_1   | OS_OPT_POST_NO_SCHED:
 609:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_ALL | OS_OPT_POST_NO_SCHED:
 610:rtos/uCOS-III/Source/os_sem.c ****              break;
 611:rtos/uCOS-III/Source/os_sem.c **** 
 612:rtos/uCOS-III/Source/os_sem.c ****         default:
 613:rtos/uCOS-III/Source/os_sem.c ****             *p_err =  OS_ERR_OPT_INVALID;
 614:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 615:rtos/uCOS-III/Source/os_sem.c ****     }
 616:rtos/uCOS-III/Source/os_sem.c **** #endif
 617:rtos/uCOS-III/Source/os_sem.c **** 
 618:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_OBJ_TYPE_CHK_EN > 0u)
 619:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type != OS_OBJ_TYPE_SEM) {                       /* Make sure semaphore was created 
 620:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_TYPE;
 621:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 622:rtos/uCOS-III/Source/os_sem.c ****     }
 623:rtos/uCOS-III/Source/os_sem.c **** #endif
 624:rtos/uCOS-III/Source/os_sem.c **** 
 625:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 626:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 627:rtos/uCOS-III/Source/os_sem.c ****     if (p_pend_list->HeadPtr == (OS_TCB *)0) {                  /* Any task waiting on semaphore?  
 628:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();                                    /* No                              
 629:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 630:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 631:rtos/uCOS-III/Source/os_sem.c ****     }
 632:rtos/uCOS-III/Source/os_sem.c **** 
 633:rtos/uCOS-III/Source/os_sem.c ****     nbr_tasks = 0u;
 634:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 635:rtos/uCOS-III/Source/os_sem.c ****     ts        = OS_TS_GET();                                    /* Get local time stamp so all task
 636:rtos/uCOS-III/Source/os_sem.c **** #else
 637:rtos/uCOS-III/Source/os_sem.c ****     ts        = 0u;
 638:rtos/uCOS-III/Source/os_sem.c **** #endif
ARM GAS  /tmp/ccmNIA1d.s 			page 25


 639:rtos/uCOS-III/Source/os_sem.c ****     while (p_pend_list->HeadPtr != (OS_TCB *)0) {
 640:rtos/uCOS-III/Source/os_sem.c ****         p_tcb = p_pend_list->HeadPtr;
 641:rtos/uCOS-III/Source/os_sem.c ****         OS_PendAbort(p_tcb,
 642:rtos/uCOS-III/Source/os_sem.c ****                      ts,
 643:rtos/uCOS-III/Source/os_sem.c ****                      OS_STATUS_PEND_ABORT);
 644:rtos/uCOS-III/Source/os_sem.c ****         nbr_tasks++;
 645:rtos/uCOS-III/Source/os_sem.c ****         if (opt != OS_OPT_PEND_ABORT_ALL) {                     /* Pend abort all tasks waiting?   
 646:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 647:rtos/uCOS-III/Source/os_sem.c ****         }
 648:rtos/uCOS-III/Source/os_sem.c ****     }
 649:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 650:rtos/uCOS-III/Source/os_sem.c **** 
 651:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 652:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 653:rtos/uCOS-III/Source/os_sem.c ****     }
 654:rtos/uCOS-III/Source/os_sem.c **** 
 655:rtos/uCOS-III/Source/os_sem.c ****    *p_err = OS_ERR_NONE;
 656:rtos/uCOS-III/Source/os_sem.c ****     return (nbr_tasks);
 657:rtos/uCOS-III/Source/os_sem.c **** }
 578              		.loc 1 657 1 view .LVU232
 579 002a 2846     		mov	r0, r5
 580 002c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 581              	.LVL51:
 582              	.L40:
 601:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_PTR_NULL;
 583              		.loc 1 601 5 is_stmt 1 view .LVU233
 601:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_PTR_NULL;
 584              		.loc 1 601 8 is_stmt 0 view .LVU234
 585 0030 80B1     		cbz	r0, .L53
 605:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_1:
 586              		.loc 1 605 5 is_stmt 1 view .LVU235
 587 0032 B1F5004F 		cmp	r1, #32768
 588 0036 04D0     		beq	.L42
 589 0038 11D8     		bhi	.L43
 590 003a 11B1     		cbz	r1, .L42
 591 003c B1F5807F 		cmp	r1, #256
 592 0040 10D1     		bne	.L44
 593              	.L42:
 610:rtos/uCOS-III/Source/os_sem.c **** 
 594              		.loc 1 610 14 view .LVU236
 619:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_TYPE;
 595              		.loc 1 619 5 view .LVU237
 619:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_TYPE;
 596              		.loc 1 619 14 is_stmt 0 view .LVU238
 597 0042 3A68     		ldr	r2, [r7]
 598              	.LVL52:
 619:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_OBJ_TYPE;
 599              		.loc 1 619 8 view .LVU239
 600 0044 1E4B     		ldr	r3, .L56+8
 601 0046 9A42     		cmp	r2, r3
 602 0048 11D0     		beq	.L45
 620:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 603              		.loc 1 620 8 is_stmt 1 view .LVU240
 620:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 604              		.loc 1 620 15 is_stmt 0 view .LVU241
 605 004a 45F6C453 		movw	r3, #24004
 606 004e 3380     		strh	r3, [r6]	@ movhi
ARM GAS  /tmp/ccmNIA1d.s 			page 26


 621:rtos/uCOS-III/Source/os_sem.c ****     }
 607              		.loc 1 621 9 is_stmt 1 view .LVU242
 621:rtos/uCOS-III/Source/os_sem.c ****     }
 608              		.loc 1 621 16 is_stmt 0 view .LVU243
 609 0050 0025     		movs	r5, #0
 610 0052 EAE7     		b	.L39
 611              	.LVL53:
 612              	.L53:
 602:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 613              		.loc 1 602 8 is_stmt 1 view .LVU244
 602:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 614              		.loc 1 602 15 is_stmt 0 view .LVU245
 615 0054 45F6C353 		movw	r3, #24003
 616 0058 1380     		strh	r3, [r2]	@ movhi
 603:rtos/uCOS-III/Source/os_sem.c ****     }
 617              		.loc 1 603 9 is_stmt 1 view .LVU246
 603:rtos/uCOS-III/Source/os_sem.c ****     }
 618              		.loc 1 603 16 is_stmt 0 view .LVU247
 619 005a 0025     		movs	r5, #0
 620 005c E5E7     		b	.L39
 621              	.L43:
 605:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_PEND_ABORT_1:
 622              		.loc 1 605 5 view .LVU248
 623 005e B1F5014F 		cmp	r1, #33024
 624 0062 EED0     		beq	.L42
 625              	.L44:
 613:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 626              		.loc 1 613 13 is_stmt 1 view .LVU249
 613:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 627              		.loc 1 613 20 is_stmt 0 view .LVU250
 628 0064 45F62563 		movw	r3, #24101
 629 0068 3380     		strh	r3, [r6]	@ movhi
 614:rtos/uCOS-III/Source/os_sem.c ****     }
 630              		.loc 1 614 14 is_stmt 1 view .LVU251
 614:rtos/uCOS-III/Source/os_sem.c ****     }
 631              		.loc 1 614 21 is_stmt 0 view .LVU252
 632 006a 0025     		movs	r5, #0
 633 006c DDE7     		b	.L39
 634              	.LVL54:
 635              	.L45:
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 636              		.loc 1 625 5 is_stmt 1 view .LVU253
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 637              		.loc 1 625 5 view .LVU254
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 638              		.loc 1 625 5 view .LVU255
 639 006e 4020     		movs	r0, #64
 640              	.LVL55:
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 641              		.loc 1 625 5 is_stmt 0 view .LVU256
 642 0070 FFF7FEFF 		bl	CPU_SR_Save
 643              	.LVL56:
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 644              		.loc 1 625 5 view .LVU257
 645 0074 8046     		mov	r8, r0
 646              	.LVL57:
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
ARM GAS  /tmp/ccmNIA1d.s 			page 27


 647              		.loc 1 625 5 is_stmt 1 view .LVU258
 625:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 648              		.loc 1 625 5 view .LVU259
 626:rtos/uCOS-III/Source/os_sem.c ****     if (p_pend_list->HeadPtr == (OS_TCB *)0) {                  /* Any task waiting on semaphore?  
 649              		.loc 1 626 5 view .LVU260
 627:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();                                    /* No                              
 650              		.loc 1 627 5 view .LVU261
 627:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();                                    /* No                              
 651              		.loc 1 627 20 is_stmt 0 view .LVU262
 652 0076 7B68     		ldr	r3, [r7, #4]
 627:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();                                    /* No                              
 653              		.loc 1 627 8 view .LVU263
 654 0078 A3B1     		cbz	r3, .L54
 633:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 655              		.loc 1 633 15 view .LVU264
 656 007a 0025     		movs	r5, #0
 657              	.LVL58:
 658              	.L46:
 639:rtos/uCOS-III/Source/os_sem.c ****         p_tcb = p_pend_list->HeadPtr;
 659              		.loc 1 639 11 is_stmt 1 view .LVU265
 639:rtos/uCOS-III/Source/os_sem.c ****         p_tcb = p_pend_list->HeadPtr;
 660              		.loc 1 639 23 is_stmt 0 view .LVU266
 661 007c 7868     		ldr	r0, [r7, #4]
 639:rtos/uCOS-III/Source/os_sem.c ****         p_tcb = p_pend_list->HeadPtr;
 662              		.loc 1 639 11 view .LVU267
 663 007e 40B1     		cbz	r0, .L47
 640:rtos/uCOS-III/Source/os_sem.c ****         OS_PendAbort(p_tcb,
 664              		.loc 1 640 9 is_stmt 1 view .LVU268
 665              	.LVL59:
 641:rtos/uCOS-III/Source/os_sem.c ****                      ts,
 666              		.loc 1 641 9 view .LVU269
 667 0080 0122     		movs	r2, #1
 668 0082 0021     		movs	r1, #0
 669 0084 FFF7FEFF 		bl	OS_PendAbort
 670              	.LVL60:
 644:rtos/uCOS-III/Source/os_sem.c ****         if (opt != OS_OPT_PEND_ABORT_ALL) {                     /* Pend abort all tasks waiting?   
 671              		.loc 1 644 9 view .LVU270
 644:rtos/uCOS-III/Source/os_sem.c ****         if (opt != OS_OPT_PEND_ABORT_ALL) {                     /* Pend abort all tasks waiting?   
 672              		.loc 1 644 18 is_stmt 0 view .LVU271
 673 0088 0135     		adds	r5, r5, #1
 674              	.LVL61:
 644:rtos/uCOS-III/Source/os_sem.c ****         if (opt != OS_OPT_PEND_ABORT_ALL) {                     /* Pend abort all tasks waiting?   
 675              		.loc 1 644 18 view .LVU272
 676 008a ADB2     		uxth	r5, r5
 677              	.LVL62:
 645:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 678              		.loc 1 645 9 is_stmt 1 view .LVU273
 645:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 679              		.loc 1 645 12 is_stmt 0 view .LVU274
 680 008c B4F5807F 		cmp	r4, #256
 681 0090 F4D0     		beq	.L46
 682              	.L47:
 649:rtos/uCOS-III/Source/os_sem.c **** 
 683              		.loc 1 649 5 is_stmt 1 view .LVU275
 649:rtos/uCOS-III/Source/os_sem.c **** 
 684              		.loc 1 649 5 view .LVU276
 649:rtos/uCOS-III/Source/os_sem.c **** 
ARM GAS  /tmp/ccmNIA1d.s 			page 28


 685              		.loc 1 649 5 view .LVU277
 686 0092 4046     		mov	r0, r8
 687 0094 FFF7FEFF 		bl	CPU_SR_Restore
 688              	.LVL63:
 649:rtos/uCOS-III/Source/os_sem.c **** 
 689              		.loc 1 649 5 view .LVU278
 649:rtos/uCOS-III/Source/os_sem.c **** 
 690              		.loc 1 649 5 view .LVU279
 651:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 691              		.loc 1 651 5 view .LVU280
 651:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 692              		.loc 1 651 8 is_stmt 0 view .LVU281
 693 0098 14F4004F 		tst	r4, #32768
 694 009c 09D0     		beq	.L55
 695              	.L49:
 655:rtos/uCOS-III/Source/os_sem.c ****     return (nbr_tasks);
 696              		.loc 1 655 4 is_stmt 1 view .LVU282
 655:rtos/uCOS-III/Source/os_sem.c ****     return (nbr_tasks);
 697              		.loc 1 655 11 is_stmt 0 view .LVU283
 698 009e 0023     		movs	r3, #0
 699 00a0 3380     		strh	r3, [r6]	@ movhi
 656:rtos/uCOS-III/Source/os_sem.c **** }
 700              		.loc 1 656 5 is_stmt 1 view .LVU284
 656:rtos/uCOS-III/Source/os_sem.c **** }
 701              		.loc 1 656 12 is_stmt 0 view .LVU285
 702 00a2 C2E7     		b	.L39
 703              	.LVL64:
 704              	.L54:
 628:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 705              		.loc 1 628 9 is_stmt 1 view .LVU286
 628:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 706              		.loc 1 628 9 view .LVU287
 628:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 707              		.loc 1 628 9 view .LVU288
 708 00a4 FFF7FEFF 		bl	CPU_SR_Restore
 709              	.LVL65:
 628:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 710              		.loc 1 628 9 view .LVU289
 628:rtos/uCOS-III/Source/os_sem.c ****        *p_err =  OS_ERR_PEND_ABORT_NONE;
 711              		.loc 1 628 9 view .LVU290
 629:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 712              		.loc 1 629 8 view .LVU291
 629:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 713              		.loc 1 629 15 is_stmt 0 view .LVU292
 714 00a8 46F2AB13 		movw	r3, #25003
 715 00ac 3380     		strh	r3, [r6]	@ movhi
 630:rtos/uCOS-III/Source/os_sem.c ****     }
 716              		.loc 1 630 9 is_stmt 1 view .LVU293
 630:rtos/uCOS-III/Source/os_sem.c ****     }
 717              		.loc 1 630 16 is_stmt 0 view .LVU294
 718 00ae 0025     		movs	r5, #0
 719 00b0 BBE7     		b	.L39
 720              	.LVL66:
 721              	.L55:
 652:rtos/uCOS-III/Source/os_sem.c ****     }
 722              		.loc 1 652 9 is_stmt 1 view .LVU295
 723 00b2 FFF7FEFF 		bl	OSSched
ARM GAS  /tmp/ccmNIA1d.s 			page 29


 724              	.LVL67:
 725 00b6 F2E7     		b	.L49
 726              	.L57:
 727              		.align	2
 728              	.L56:
 729 00b8 00000000 		.word	OSIntNestingCtr
 730 00bc 00000000 		.word	OSRunning
 731 00c0 53454D41 		.word	1095583059
 732              		.cfi_endproc
 733              	.LFE3:
 735              		.section	.text.OSSemPost,"ax",%progbits
 736              		.align	1
 737              		.global	OSSemPost
 738              		.syntax unified
 739              		.thumb
 740              		.thumb_func
 741              		.fpu fpv4-sp-d16
 743              	OSSemPost:
 744              	.LVL68:
 745              	.LFB4:
 658:rtos/uCOS-III/Source/os_sem.c **** #endif
 659:rtos/uCOS-III/Source/os_sem.c **** 
 660:rtos/uCOS-III/Source/os_sem.c **** 
 661:rtos/uCOS-III/Source/os_sem.c **** /*
 662:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 663:rtos/uCOS-III/Source/os_sem.c **** *                                                 POST TO A SEMAPHORE
 664:rtos/uCOS-III/Source/os_sem.c **** *
 665:rtos/uCOS-III/Source/os_sem.c **** * Description: This function signals a semaphore.
 666:rtos/uCOS-III/Source/os_sem.c **** *
 667:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem    is a pointer to the semaphore
 668:rtos/uCOS-III/Source/os_sem.c **** *
 669:rtos/uCOS-III/Source/os_sem.c **** *              opt      determines the type of POST performed:
 670:rtos/uCOS-III/Source/os_sem.c **** *
 671:rtos/uCOS-III/Source/os_sem.c **** *                           OS_OPT_POST_1            POST and ready only the highest priority task 
 672:rtos/uCOS-III/Source/os_sem.c **** *                                                    (if tasks are waiting).
 673:rtos/uCOS-III/Source/os_sem.c **** *                           OS_OPT_POST_ALL          POST to ALL tasks that are waiting on the sema
 674:rtos/uCOS-III/Source/os_sem.c **** *
 675:rtos/uCOS-III/Source/os_sem.c **** *                           OS_OPT_POST_NO_SCHED     Do not call the scheduler
 676:rtos/uCOS-III/Source/os_sem.c **** *
 677:rtos/uCOS-III/Source/os_sem.c **** *
 678:rtos/uCOS-III/Source/os_sem.c **** *              p_err    is a pointer to a variable that will contain an error code returned by this
 679:rtos/uCOS-III/Source/os_sem.c **** *
 680:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_NONE              The call was successful and the semaphore was 
 681:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_OBJ_PTR_NULL      If 'p_sem' is a NULL pointer
 682:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_OBJ_TYPE          If 'p_sem' is not pointing at a semaphore
 683:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_OPT_INVALID       If you specified an invalid option
 684:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_OS_NOT_RUNNING    If uC/OS-III is not running yet
 685:rtos/uCOS-III/Source/os_sem.c **** *                           OS_ERR_SEM_OVF           If the post would cause the semaphore count to
 686:rtos/uCOS-III/Source/os_sem.c **** *
 687:rtos/uCOS-III/Source/os_sem.c **** * Returns    : The current value of the semaphore counter or 0 upon error.
 688:rtos/uCOS-III/Source/os_sem.c **** *
 689:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : 1) OS_OPT_POST_NO_SCHED can be added with one of the other options.
 690:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 691:rtos/uCOS-III/Source/os_sem.c **** */
 692:rtos/uCOS-III/Source/os_sem.c **** 
 693:rtos/uCOS-III/Source/os_sem.c **** OS_SEM_CTR  OSSemPost (OS_SEM  *p_sem,
 694:rtos/uCOS-III/Source/os_sem.c ****                        OS_OPT   opt,
ARM GAS  /tmp/ccmNIA1d.s 			page 30


 695:rtos/uCOS-III/Source/os_sem.c ****                        OS_ERR  *p_err)
 696:rtos/uCOS-III/Source/os_sem.c **** {
 746              		.loc 1 696 1 view -0
 747              		.cfi_startproc
 748              		@ args = 0, pretend = 0, frame = 0
 749              		@ frame_needed = 0, uses_anonymous_args = 0
 750              		.loc 1 696 1 is_stmt 0 view .LVU297
 751 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 752              	.LCFI3:
 753              		.cfi_def_cfa_offset 24
 754              		.cfi_offset 4, -24
 755              		.cfi_offset 5, -20
 756              		.cfi_offset 6, -16
 757              		.cfi_offset 7, -12
 758              		.cfi_offset 8, -8
 759              		.cfi_offset 14, -4
 760 0004 82B0     		sub	sp, sp, #8
 761              	.LCFI4:
 762              		.cfi_def_cfa_offset 32
 763 0006 1646     		mov	r6, r2
 697:rtos/uCOS-III/Source/os_sem.c ****     OS_SEM_CTR     ctr;
 764              		.loc 1 697 5 is_stmt 1 view .LVU298
 698:rtos/uCOS-III/Source/os_sem.c ****     OS_PEND_LIST  *p_pend_list;
 765              		.loc 1 698 5 view .LVU299
 699:rtos/uCOS-III/Source/os_sem.c ****     OS_TCB        *p_tcb;
 766              		.loc 1 699 5 view .LVU300
 700:rtos/uCOS-III/Source/os_sem.c ****     OS_TCB        *p_tcb_next;
 767              		.loc 1 700 5 view .LVU301
 701:rtos/uCOS-III/Source/os_sem.c ****     CPU_TS         ts;
 768              		.loc 1 701 5 view .LVU302
 702:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 769              		.loc 1 702 5 view .LVU303
 770              	.LVL69:
 703:rtos/uCOS-III/Source/os_sem.c **** 
 704:rtos/uCOS-III/Source/os_sem.c **** 
 705:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
 706:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
 707:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
 708:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 709:rtos/uCOS-III/Source/os_sem.c ****     }
 710:rtos/uCOS-III/Source/os_sem.c **** #endif
 711:rtos/uCOS-III/Source/os_sem.c **** 
 712:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_POST_ENTER(p_sem, opt);
 771              		.loc 1 712 40 view .LVU304
 713:rtos/uCOS-III/Source/os_sem.c **** 
 714:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_INVALID_OS_CALLS_CHK_EN > 0u)
 715:rtos/uCOS-III/Source/os_sem.c ****     if (OSRunning != OS_STATE_OS_RUNNING) {                     /* Is the kernel running?          
 772              		.loc 1 715 5 view .LVU305
 773              		.loc 1 715 19 is_stmt 0 view .LVU306
 774 0008 2E4B     		ldr	r3, .L76
 775 000a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 776              		.loc 1 715 8 view .LVU307
 777 000c 012B     		cmp	r3, #1
 778 000e 07D0     		beq	.L59
 716:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(OS_ERR_OS_NOT_RUNNING);
 779              		.loc 1 716 54 is_stmt 1 view .LVU308
 717:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OS_NOT_RUNNING;
ARM GAS  /tmp/ccmNIA1d.s 			page 31


 780              		.loc 1 717 8 view .LVU309
 781              		.loc 1 717 15 is_stmt 0 view .LVU310
 782 0010 45F68963 		movw	r3, #24201
 783 0014 1380     		strh	r3, [r2]	@ movhi
 718:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 784              		.loc 1 718 9 is_stmt 1 view .LVU311
 785              		.loc 1 718 16 is_stmt 0 view .LVU312
 786 0016 0024     		movs	r4, #0
 787              	.LVL70:
 788              	.L58:
 719:rtos/uCOS-III/Source/os_sem.c ****     }
 720:rtos/uCOS-III/Source/os_sem.c **** #endif
 721:rtos/uCOS-III/Source/os_sem.c **** 
 722:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 723:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
 724:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 725:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(OS_ERR_OBJ_PTR_NULL);
 726:rtos/uCOS-III/Source/os_sem.c ****        *p_err  = OS_ERR_OBJ_PTR_NULL;
 727:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 728:rtos/uCOS-III/Source/os_sem.c ****     }
 729:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {                                              /* Validate 'opt'                  
 730:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_1:
 731:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_ALL:
 732:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_1   | OS_OPT_POST_NO_SCHED:
 733:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_ALL | OS_OPT_POST_NO_SCHED:
 734:rtos/uCOS-III/Source/os_sem.c ****              break;
 735:rtos/uCOS-III/Source/os_sem.c **** 
 736:rtos/uCOS-III/Source/os_sem.c ****         default:
 737:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_POST_FAILED(p_sem);
 738:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_POST_EXIT(OS_ERR_OPT_INVALID);
 739:rtos/uCOS-III/Source/os_sem.c ****             *p_err =  OS_ERR_OPT_INVALID;
 740:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 741:rtos/uCOS-III/Source/os_sem.c ****     }
 742:rtos/uCOS-III/Source/os_sem.c **** #endif
 743:rtos/uCOS-III/Source/os_sem.c **** 
 744:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_OBJ_TYPE_CHK_EN > 0u)
 745:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type != OS_OBJ_TYPE_SEM) {                       /* Make sure semaphore was created 
 746:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 747:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(OS_ERR_OBJ_TYPE);
 748:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 749:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 750:rtos/uCOS-III/Source/os_sem.c ****     }
 751:rtos/uCOS-III/Source/os_sem.c **** #endif
 752:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 753:rtos/uCOS-III/Source/os_sem.c ****     ts = OS_TS_GET();                                           /* Get timestamp                   
 754:rtos/uCOS-III/Source/os_sem.c **** #else
 755:rtos/uCOS-III/Source/os_sem.c ****     ts = 0u;
 756:rtos/uCOS-III/Source/os_sem.c **** #endif
 757:rtos/uCOS-III/Source/os_sem.c **** 
 758:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_POST(p_sem);
 759:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 760:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 761:rtos/uCOS-III/Source/os_sem.c ****     if (p_pend_list->HeadPtr == (OS_TCB *)0) {                  /* Any task waiting on semaphore?  
 762:rtos/uCOS-III/Source/os_sem.c ****         if (p_sem->Ctr == (OS_SEM_CTR)-1) {
 763:rtos/uCOS-III/Source/os_sem.c ****            CPU_CRITICAL_EXIT();
 764:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 765:rtos/uCOS-III/Source/os_sem.c ****            OS_TRACE_SEM_POST_EXIT(*p_err);
ARM GAS  /tmp/ccmNIA1d.s 			page 32


 766:rtos/uCOS-III/Source/os_sem.c ****            return (0u);
 767:rtos/uCOS-III/Source/os_sem.c ****         }
 768:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr++;                                           /* No                              
 769:rtos/uCOS-III/Source/os_sem.c ****         ctr       = p_sem->Ctr;
 770:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 771:rtos/uCOS-III/Source/os_sem.c ****         p_sem->TS = ts;                                         /* Save timestamp in semaphore cont
 772:rtos/uCOS-III/Source/os_sem.c **** #endif
 773:rtos/uCOS-III/Source/os_sem.c ****         CPU_CRITICAL_EXIT();
 774:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 775:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(*p_err);
 776:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 777:rtos/uCOS-III/Source/os_sem.c ****     }
 778:rtos/uCOS-III/Source/os_sem.c **** 
 779:rtos/uCOS-III/Source/os_sem.c ****     p_tcb = p_pend_list->HeadPtr;
 780:rtos/uCOS-III/Source/os_sem.c ****     while (p_tcb != (OS_TCB *)0) {
 781:rtos/uCOS-III/Source/os_sem.c ****         p_tcb_next = p_tcb->PendNextPtr;
 782:rtos/uCOS-III/Source/os_sem.c ****         OS_Post((OS_PEND_OBJ *)((void *)p_sem),
 783:rtos/uCOS-III/Source/os_sem.c ****                 p_tcb,
 784:rtos/uCOS-III/Source/os_sem.c ****                 (void *)0,
 785:rtos/uCOS-III/Source/os_sem.c ****                 0u,
 786:rtos/uCOS-III/Source/os_sem.c ****                 ts);
 787:rtos/uCOS-III/Source/os_sem.c ****         if ((opt & OS_OPT_POST_ALL) == 0u) {                     /* Post to all tasks waiting?     
 788:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 789:rtos/uCOS-III/Source/os_sem.c ****         }
 790:rtos/uCOS-III/Source/os_sem.c ****         p_tcb = p_tcb_next;
 791:rtos/uCOS-III/Source/os_sem.c ****     }
 792:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 793:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 794:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 795:rtos/uCOS-III/Source/os_sem.c ****     }
 796:rtos/uCOS-III/Source/os_sem.c ****    *p_err = OS_ERR_NONE;
 797:rtos/uCOS-III/Source/os_sem.c **** 
 798:rtos/uCOS-III/Source/os_sem.c ****     OS_TRACE_SEM_POST_EXIT(*p_err);
 799:rtos/uCOS-III/Source/os_sem.c ****     return (0u);
 800:rtos/uCOS-III/Source/os_sem.c **** }
 789              		.loc 1 800 1 view .LVU313
 790 0018 2046     		mov	r0, r4
 791 001a 02B0     		add	sp, sp, #8
 792              	.LCFI5:
 793              		.cfi_remember_state
 794              		.cfi_def_cfa_offset 24
 795              		@ sp needed
 796 001c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 797              	.LVL71:
 798              	.L59:
 799              	.LCFI6:
 800              		.cfi_restore_state
 801              		.loc 1 800 1 view .LVU314
 802 0020 0546     		mov	r5, r0
 803 0022 0C46     		mov	r4, r1
 723:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 804              		.loc 1 723 5 is_stmt 1 view .LVU315
 723:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 805              		.loc 1 723 8 is_stmt 0 view .LVU316
 806 0024 80B1     		cbz	r0, .L72
 729:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_1:
 807              		.loc 1 729 5 is_stmt 1 view .LVU317
ARM GAS  /tmp/ccmNIA1d.s 			page 33


 808 0026 B1F5004F 		cmp	r1, #32768
 809 002a 04D0     		beq	.L62
 810 002c 11D8     		bhi	.L63
 811 002e 11B1     		cbz	r1, .L62
 812 0030 B1F5007F 		cmp	r1, #512
 813 0034 10D1     		bne	.L64
 814              	.L62:
 734:rtos/uCOS-III/Source/os_sem.c **** 
 815              		.loc 1 734 14 view .LVU318
 745:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 816              		.loc 1 745 5 view .LVU319
 745:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 817              		.loc 1 745 14 is_stmt 0 view .LVU320
 818 0036 2A68     		ldr	r2, [r5]
 819              	.LVL72:
 745:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_FAILED(p_sem);
 820              		.loc 1 745 8 view .LVU321
 821 0038 234B     		ldr	r3, .L76+4
 822 003a 9A42     		cmp	r2, r3
 823 003c 11D0     		beq	.L65
 746:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(OS_ERR_OBJ_TYPE);
 824              		.loc 1 746 40 is_stmt 1 view .LVU322
 747:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 825              		.loc 1 747 48 view .LVU323
 748:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 826              		.loc 1 748 8 view .LVU324
 748:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 827              		.loc 1 748 15 is_stmt 0 view .LVU325
 828 003e 45F6C453 		movw	r3, #24004
 829 0042 3380     		strh	r3, [r6]	@ movhi
 749:rtos/uCOS-III/Source/os_sem.c ****     }
 830              		.loc 1 749 9 is_stmt 1 view .LVU326
 749:rtos/uCOS-III/Source/os_sem.c ****     }
 831              		.loc 1 749 16 is_stmt 0 view .LVU327
 832 0044 0024     		movs	r4, #0
 833 0046 E7E7     		b	.L58
 834              	.LVL73:
 835              	.L72:
 724:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(OS_ERR_OBJ_PTR_NULL);
 836              		.loc 1 724 40 is_stmt 1 view .LVU328
 725:rtos/uCOS-III/Source/os_sem.c ****        *p_err  = OS_ERR_OBJ_PTR_NULL;
 837              		.loc 1 725 52 view .LVU329
 726:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 838              		.loc 1 726 8 view .LVU330
 726:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 839              		.loc 1 726 16 is_stmt 0 view .LVU331
 840 0048 45F6C353 		movw	r3, #24003
 841 004c 1380     		strh	r3, [r2]	@ movhi
 727:rtos/uCOS-III/Source/os_sem.c ****     }
 842              		.loc 1 727 9 is_stmt 1 view .LVU332
 727:rtos/uCOS-III/Source/os_sem.c ****     }
 843              		.loc 1 727 16 is_stmt 0 view .LVU333
 844 004e 0024     		movs	r4, #0
 845 0050 E2E7     		b	.L58
 846              	.L63:
 729:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_POST_1:
 847              		.loc 1 729 5 view .LVU334
ARM GAS  /tmp/ccmNIA1d.s 			page 34


 848 0052 B1F5024F 		cmp	r1, #33280
 849 0056 EED0     		beq	.L62
 850              	.L64:
 737:rtos/uCOS-III/Source/os_sem.c ****              OS_TRACE_SEM_POST_EXIT(OS_ERR_OPT_INVALID);
 851              		.loc 1 737 45 is_stmt 1 view .LVU335
 738:rtos/uCOS-III/Source/os_sem.c ****             *p_err =  OS_ERR_OPT_INVALID;
 852              		.loc 1 738 56 view .LVU336
 739:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 853              		.loc 1 739 13 view .LVU337
 739:rtos/uCOS-III/Source/os_sem.c ****              return (0u);
 854              		.loc 1 739 20 is_stmt 0 view .LVU338
 855 0058 45F62563 		movw	r3, #24101
 856 005c 3380     		strh	r3, [r6]	@ movhi
 740:rtos/uCOS-III/Source/os_sem.c ****     }
 857              		.loc 1 740 14 is_stmt 1 view .LVU339
 740:rtos/uCOS-III/Source/os_sem.c ****     }
 858              		.loc 1 740 21 is_stmt 0 view .LVU340
 859 005e 0024     		movs	r4, #0
 860 0060 DAE7     		b	.L58
 861              	.LVL74:
 862              	.L65:
 755:rtos/uCOS-III/Source/os_sem.c **** #endif
 863              		.loc 1 755 5 is_stmt 1 view .LVU341
 758:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 864              		.loc 1 758 29 view .LVU342
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 865              		.loc 1 759 5 view .LVU343
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 866              		.loc 1 759 5 view .LVU344
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 867              		.loc 1 759 5 view .LVU345
 868 0062 4020     		movs	r0, #64
 869              	.LVL75:
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 870              		.loc 1 759 5 is_stmt 0 view .LVU346
 871 0064 FFF7FEFF 		bl	CPU_SR_Save
 872              	.LVL76:
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 873              		.loc 1 759 5 view .LVU347
 874 0068 8046     		mov	r8, r0
 875              	.LVL77:
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 876              		.loc 1 759 5 is_stmt 1 view .LVU348
 759:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 877              		.loc 1 759 5 view .LVU349
 760:rtos/uCOS-III/Source/os_sem.c ****     if (p_pend_list->HeadPtr == (OS_TCB *)0) {                  /* Any task waiting on semaphore?  
 878              		.loc 1 760 5 view .LVU350
 761:rtos/uCOS-III/Source/os_sem.c ****         if (p_sem->Ctr == (OS_SEM_CTR)-1) {
 879              		.loc 1 761 5 view .LVU351
 761:rtos/uCOS-III/Source/os_sem.c ****         if (p_sem->Ctr == (OS_SEM_CTR)-1) {
 880              		.loc 1 761 20 is_stmt 0 view .LVU352
 881 006a 6968     		ldr	r1, [r5, #4]
 761:rtos/uCOS-III/Source/os_sem.c ****         if (p_sem->Ctr == (OS_SEM_CTR)-1) {
 882              		.loc 1 761 8 view .LVU353
 883 006c 61B1     		cbz	r1, .L73
 884              	.LVL78:
 885              	.L66:
ARM GAS  /tmp/ccmNIA1d.s 			page 35


 780:rtos/uCOS-III/Source/os_sem.c ****         p_tcb_next = p_tcb->PendNextPtr;
 886              		.loc 1 780 11 is_stmt 1 view .LVU354
 887 006e E9B1     		cbz	r1, .L68
 781:rtos/uCOS-III/Source/os_sem.c ****         OS_Post((OS_PEND_OBJ *)((void *)p_sem),
 888              		.loc 1 781 9 view .LVU355
 781:rtos/uCOS-III/Source/os_sem.c ****         OS_Post((OS_PEND_OBJ *)((void *)p_sem),
 889              		.loc 1 781 20 is_stmt 0 view .LVU356
 890 0070 0F6A     		ldr	r7, [r1, #32]
 891              	.LVL79:
 782:rtos/uCOS-III/Source/os_sem.c ****                 p_tcb,
 892              		.loc 1 782 9 is_stmt 1 view .LVU357
 893 0072 0022     		movs	r2, #0
 894 0074 0092     		str	r2, [sp]
 895 0076 1346     		mov	r3, r2
 896 0078 2846     		mov	r0, r5
 897 007a FFF7FEFF 		bl	OS_Post
 898              	.LVL80:
 787:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 899              		.loc 1 787 9 view .LVU358
 787:rtos/uCOS-III/Source/os_sem.c ****             break;                                              /* No                              
 900              		.loc 1 787 12 is_stmt 0 view .LVU359
 901 007e 14F4007F 		tst	r4, #512
 902 0082 13D0     		beq	.L68
 790:rtos/uCOS-III/Source/os_sem.c ****     }
 903              		.loc 1 790 15 view .LVU360
 904 0084 3946     		mov	r1, r7
 905 0086 F2E7     		b	.L66
 906              	.LVL81:
 907              	.L73:
 762:rtos/uCOS-III/Source/os_sem.c ****            CPU_CRITICAL_EXIT();
 908              		.loc 1 762 9 is_stmt 1 view .LVU361
 762:rtos/uCOS-III/Source/os_sem.c ****            CPU_CRITICAL_EXIT();
 909              		.loc 1 762 18 is_stmt 0 view .LVU362
 910 0088 EC68     		ldr	r4, [r5, #12]
 762:rtos/uCOS-III/Source/os_sem.c ****            CPU_CRITICAL_EXIT();
 911              		.loc 1 762 12 view .LVU363
 912 008a B4F1FF3F 		cmp	r4, #-1
 913 008e 06D0     		beq	.L74
 768:rtos/uCOS-III/Source/os_sem.c ****         ctr       = p_sem->Ctr;
 914              		.loc 1 768 9 is_stmt 1 view .LVU364
 768:rtos/uCOS-III/Source/os_sem.c ****         ctr       = p_sem->Ctr;
 915              		.loc 1 768 19 is_stmt 0 view .LVU365
 916 0090 0134     		adds	r4, r4, #1
 917 0092 EC60     		str	r4, [r5, #12]
 769:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 918              		.loc 1 769 9 is_stmt 1 view .LVU366
 919              	.LVL82:
 773:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 920              		.loc 1 773 9 view .LVU367
 773:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 921              		.loc 1 773 9 view .LVU368
 773:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 922              		.loc 1 773 9 view .LVU369
 923 0094 FFF7FEFF 		bl	CPU_SR_Restore
 924              	.LVL83:
 773:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 925              		.loc 1 773 9 view .LVU370
ARM GAS  /tmp/ccmNIA1d.s 			page 36


 773:rtos/uCOS-III/Source/os_sem.c ****        *p_err     = OS_ERR_NONE;
 926              		.loc 1 773 9 view .LVU371
 774:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(*p_err);
 927              		.loc 1 774 8 view .LVU372
 774:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_POST_EXIT(*p_err);
 928              		.loc 1 774 19 is_stmt 0 view .LVU373
 929 0098 0023     		movs	r3, #0
 930 009a 3380     		strh	r3, [r6]	@ movhi
 775:rtos/uCOS-III/Source/os_sem.c ****         return (ctr);
 931              		.loc 1 775 39 is_stmt 1 view .LVU374
 776:rtos/uCOS-III/Source/os_sem.c ****     }
 932              		.loc 1 776 9 view .LVU375
 776:rtos/uCOS-III/Source/os_sem.c ****     }
 933              		.loc 1 776 16 is_stmt 0 view .LVU376
 934 009c BCE7     		b	.L58
 935              	.LVL84:
 936              	.L74:
 763:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 937              		.loc 1 763 12 is_stmt 1 view .LVU377
 763:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 938              		.loc 1 763 12 view .LVU378
 763:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 939              		.loc 1 763 12 view .LVU379
 940 009e FFF7FEFF 		bl	CPU_SR_Restore
 941              	.LVL85:
 763:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 942              		.loc 1 763 12 view .LVU380
 763:rtos/uCOS-III/Source/os_sem.c ****           *p_err = OS_ERR_SEM_OVF;
 943              		.loc 1 763 12 view .LVU381
 764:rtos/uCOS-III/Source/os_sem.c ****            OS_TRACE_SEM_POST_EXIT(*p_err);
 944              		.loc 1 764 11 view .LVU382
 764:rtos/uCOS-III/Source/os_sem.c ****            OS_TRACE_SEM_POST_EXIT(*p_err);
 945              		.loc 1 764 18 is_stmt 0 view .LVU383
 946 00a2 46F6C553 		movw	r3, #28101
 947 00a6 3380     		strh	r3, [r6]	@ movhi
 765:rtos/uCOS-III/Source/os_sem.c ****            return (0u);
 948              		.loc 1 765 42 is_stmt 1 view .LVU384
 766:rtos/uCOS-III/Source/os_sem.c ****         }
 949              		.loc 1 766 12 view .LVU385
 766:rtos/uCOS-III/Source/os_sem.c ****         }
 950              		.loc 1 766 19 is_stmt 0 view .LVU386
 951 00a8 0024     		movs	r4, #0
 952 00aa B5E7     		b	.L58
 953              	.L68:
 792:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 954              		.loc 1 792 5 is_stmt 1 view .LVU387
 792:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 955              		.loc 1 792 5 view .LVU388
 792:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 956              		.loc 1 792 5 view .LVU389
 957 00ac 4046     		mov	r0, r8
 958 00ae FFF7FEFF 		bl	CPU_SR_Restore
 959              	.LVL86:
 792:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 960              		.loc 1 792 5 view .LVU390
 792:rtos/uCOS-III/Source/os_sem.c ****     if ((opt & OS_OPT_POST_NO_SCHED) == 0u) {
 961              		.loc 1 792 5 view .LVU391
ARM GAS  /tmp/ccmNIA1d.s 			page 37


 793:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 962              		.loc 1 793 5 view .LVU392
 793:rtos/uCOS-III/Source/os_sem.c ****         OSSched();                                              /* Run the scheduler               
 963              		.loc 1 793 8 is_stmt 0 view .LVU393
 964 00b2 14F4004F 		tst	r4, #32768
 965 00b6 02D0     		beq	.L75
 966              	.L70:
 796:rtos/uCOS-III/Source/os_sem.c **** 
 967              		.loc 1 796 4 is_stmt 1 view .LVU394
 796:rtos/uCOS-III/Source/os_sem.c **** 
 968              		.loc 1 796 11 is_stmt 0 view .LVU395
 969 00b8 0024     		movs	r4, #0
 970 00ba 3480     		strh	r4, [r6]	@ movhi
 798:rtos/uCOS-III/Source/os_sem.c ****     return (0u);
 971              		.loc 1 798 35 is_stmt 1 view .LVU396
 799:rtos/uCOS-III/Source/os_sem.c **** }
 972              		.loc 1 799 5 view .LVU397
 799:rtos/uCOS-III/Source/os_sem.c **** }
 973              		.loc 1 799 12 is_stmt 0 view .LVU398
 974 00bc ACE7     		b	.L58
 975              	.L75:
 794:rtos/uCOS-III/Source/os_sem.c ****     }
 976              		.loc 1 794 9 is_stmt 1 view .LVU399
 977 00be FFF7FEFF 		bl	OSSched
 978              	.LVL87:
 979 00c2 F9E7     		b	.L70
 980              	.L77:
 981              		.align	2
 982              	.L76:
 983 00c4 00000000 		.word	OSRunning
 984 00c8 53454D41 		.word	1095583059
 985              		.cfi_endproc
 986              	.LFE4:
 988              		.section	.text.OSSemSet,"ax",%progbits
 989              		.align	1
 990              		.global	OSSemSet
 991              		.syntax unified
 992              		.thumb
 993              		.thumb_func
 994              		.fpu fpv4-sp-d16
 996              	OSSemSet:
 997              	.LVL88:
 998              	.LFB5:
 801:rtos/uCOS-III/Source/os_sem.c **** 
 802:rtos/uCOS-III/Source/os_sem.c **** 
 803:rtos/uCOS-III/Source/os_sem.c **** /*
 804:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 805:rtos/uCOS-III/Source/os_sem.c **** *                                                    SET SEMAPHORE
 806:rtos/uCOS-III/Source/os_sem.c **** *
 807:rtos/uCOS-III/Source/os_sem.c **** * Description: This function sets the semaphore count to the value specified as an argument.  Typic
 808:rtos/uCOS-III/Source/os_sem.c **** *              would be 0 but of course, we can set the semaphore to any value.
 809:rtos/uCOS-III/Source/os_sem.c **** *
 810:rtos/uCOS-III/Source/os_sem.c **** *              You would typically use this function when a semaphore is used as a signaling mechan
 811:rtos/uCOS-III/Source/os_sem.c **** *              and, you want to reset the count value.
 812:rtos/uCOS-III/Source/os_sem.c **** *
 813:rtos/uCOS-III/Source/os_sem.c **** * Arguments  : p_sem     is a pointer to the semaphore
 814:rtos/uCOS-III/Source/os_sem.c **** *
ARM GAS  /tmp/ccmNIA1d.s 			page 38


 815:rtos/uCOS-III/Source/os_sem.c **** *              cnt       is the new value for the semaphore count.  You would pass 0 to reset the s
 816:rtos/uCOS-III/Source/os_sem.c **** *
 817:rtos/uCOS-III/Source/os_sem.c **** *              p_err     is a pointer to a variable that will contain an error code returned by thi
 818:rtos/uCOS-III/Source/os_sem.c **** *
 819:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_NONE           The call was successful and the semaphore value 
 820:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OBJ_PTR_NULL   If 'p_sem' is a NULL pointer
 821:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_OBJ_TYPE       If 'p_sem' is not pointing to a semaphore
 822:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_SET_ISR        If called from an ISR
 823:rtos/uCOS-III/Source/os_sem.c **** *                            OS_ERR_TASK_WAITING   If tasks are waiting on the semaphore
 824:rtos/uCOS-III/Source/os_sem.c **** *
 825:rtos/uCOS-III/Source/os_sem.c **** * Returns    : None
 826:rtos/uCOS-III/Source/os_sem.c **** *
 827:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : none
 828:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 829:rtos/uCOS-III/Source/os_sem.c **** */
 830:rtos/uCOS-III/Source/os_sem.c **** 
 831:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_SEM_SET_EN > 0u)
 832:rtos/uCOS-III/Source/os_sem.c **** void  OSSemSet (OS_SEM      *p_sem,
 833:rtos/uCOS-III/Source/os_sem.c ****                 OS_SEM_CTR   cnt,
 834:rtos/uCOS-III/Source/os_sem.c ****                 OS_ERR      *p_err)
 835:rtos/uCOS-III/Source/os_sem.c **** {
 999              		.loc 1 835 1 view -0
 1000              		.cfi_startproc
 1001              		@ args = 0, pretend = 0, frame = 0
 1002              		@ frame_needed = 0, uses_anonymous_args = 0
 1003              		.loc 1 835 1 is_stmt 0 view .LVU401
 1004 0000 70B5     		push	{r4, r5, r6, lr}
 1005              	.LCFI7:
 1006              		.cfi_def_cfa_offset 16
 1007              		.cfi_offset 4, -16
 1008              		.cfi_offset 5, -12
 1009              		.cfi_offset 6, -8
 1010              		.cfi_offset 14, -4
 1011 0002 1546     		mov	r5, r2
 836:rtos/uCOS-III/Source/os_sem.c ****     OS_PEND_LIST  *p_pend_list;
 1012              		.loc 1 836 5 is_stmt 1 view .LVU402
 837:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 1013              		.loc 1 837 5 view .LVU403
 1014              	.LVL89:
 838:rtos/uCOS-III/Source/os_sem.c **** 
 839:rtos/uCOS-III/Source/os_sem.c **** 
 840:rtos/uCOS-III/Source/os_sem.c **** #ifdef OS_SAFETY_CRITICAL
 841:rtos/uCOS-III/Source/os_sem.c ****     if (p_err == (OS_ERR *)0) {
 842:rtos/uCOS-III/Source/os_sem.c ****         OS_SAFETY_CRITICAL_EXCEPTION();
 843:rtos/uCOS-III/Source/os_sem.c ****         return;
 844:rtos/uCOS-III/Source/os_sem.c ****     }
 845:rtos/uCOS-III/Source/os_sem.c **** #endif
 846:rtos/uCOS-III/Source/os_sem.c **** 
 847:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_CALLED_FROM_ISR_CHK_EN > 0u)
 848:rtos/uCOS-III/Source/os_sem.c ****     if (OSIntNestingCtr > 0u) {                                 /* Can't call this function from an
 1015              		.loc 1 848 5 view .LVU404
 1016              		.loc 1 848 25 is_stmt 0 view .LVU405
 1017 0004 144B     		ldr	r3, .L90
 1018 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1019              		.loc 1 848 8 view .LVU406
 1020 0008 53B9     		cbnz	r3, .L87
 1021 000a 0446     		mov	r4, r0
ARM GAS  /tmp/ccmNIA1d.s 			page 39


 1022 000c 0E46     		mov	r6, r1
 849:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_SET_ISR;
 850:rtos/uCOS-III/Source/os_sem.c ****         return;
 851:rtos/uCOS-III/Source/os_sem.c ****     }
 852:rtos/uCOS-III/Source/os_sem.c **** #endif
 853:rtos/uCOS-III/Source/os_sem.c **** 
 854:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_ARG_CHK_EN > 0u)
 855:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem == (OS_SEM *)0) {                                 /* Validate 'p_sem'                
 1023              		.loc 1 855 5 is_stmt 1 view .LVU407
 1024              		.loc 1 855 8 is_stmt 0 view .LVU408
 1025 000e 58B1     		cbz	r0, .L88
 856:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 857:rtos/uCOS-III/Source/os_sem.c ****         return;
 858:rtos/uCOS-III/Source/os_sem.c ****     }
 859:rtos/uCOS-III/Source/os_sem.c **** #endif
 860:rtos/uCOS-III/Source/os_sem.c **** 
 861:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_OBJ_TYPE_CHK_EN > 0u)
 862:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Type != OS_OBJ_TYPE_SEM) {                       /* Make sure semaphore was created 
 1026              		.loc 1 862 5 is_stmt 1 view .LVU409
 1027              		.loc 1 862 14 is_stmt 0 view .LVU410
 1028 0010 0268     		ldr	r2, [r0]
 1029              	.LVL90:
 1030              		.loc 1 862 8 view .LVU411
 1031 0012 124B     		ldr	r3, .L90+4
 1032 0014 9A42     		cmp	r2, r3
 1033 0016 0BD0     		beq	.L82
 863:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 1034              		.loc 1 863 8 is_stmt 1 view .LVU412
 1035              		.loc 1 863 15 is_stmt 0 view .LVU413
 1036 0018 45F6C453 		movw	r3, #24004
 1037 001c 2B80     		strh	r3, [r5]	@ movhi
 864:rtos/uCOS-III/Source/os_sem.c ****         return;
 1038              		.loc 1 864 9 is_stmt 1 view .LVU414
 1039              	.LVL91:
 1040              	.L78:
 865:rtos/uCOS-III/Source/os_sem.c ****     }
 866:rtos/uCOS-III/Source/os_sem.c **** #endif
 867:rtos/uCOS-III/Source/os_sem.c **** 
 868:rtos/uCOS-III/Source/os_sem.c ****    *p_err = OS_ERR_NONE;
 869:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 870:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 871:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr = cnt;                                       /* Yes, set it to the new value spe
 872:rtos/uCOS-III/Source/os_sem.c ****     } else {
 873:rtos/uCOS-III/Source/os_sem.c ****         p_pend_list = &p_sem->PendList;                         /* No                              
 874:rtos/uCOS-III/Source/os_sem.c ****         if (p_pend_list->HeadPtr == (OS_TCB *)0) {              /* See if task(s) waiting?         
 875:rtos/uCOS-III/Source/os_sem.c ****             p_sem->Ctr = cnt;                                   /* No, OK to set the value         
 876:rtos/uCOS-III/Source/os_sem.c ****         } else {
 877:rtos/uCOS-III/Source/os_sem.c ****            *p_err      = OS_ERR_TASK_WAITING;
 878:rtos/uCOS-III/Source/os_sem.c ****         }
 879:rtos/uCOS-III/Source/os_sem.c ****     }
 880:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_EXIT();
 881:rtos/uCOS-III/Source/os_sem.c **** }
 1041              		.loc 1 881 1 is_stmt 0 view .LVU415
 1042 001e 70BD     		pop	{r4, r5, r6, pc}
 1043              	.LVL92:
 1044              	.L87:
 849:rtos/uCOS-III/Source/os_sem.c ****         return;
ARM GAS  /tmp/ccmNIA1d.s 			page 40


 1045              		.loc 1 849 8 is_stmt 1 view .LVU416
 849:rtos/uCOS-III/Source/os_sem.c ****         return;
 1046              		.loc 1 849 15 is_stmt 0 view .LVU417
 1047 0020 46F6C653 		movw	r3, #28102
 1048 0024 1380     		strh	r3, [r2]	@ movhi
 850:rtos/uCOS-III/Source/os_sem.c ****     }
 1049              		.loc 1 850 9 is_stmt 1 view .LVU418
 1050 0026 FAE7     		b	.L78
 1051              	.L88:
 856:rtos/uCOS-III/Source/os_sem.c ****         return;
 1052              		.loc 1 856 8 view .LVU419
 856:rtos/uCOS-III/Source/os_sem.c ****         return;
 1053              		.loc 1 856 15 is_stmt 0 view .LVU420
 1054 0028 45F6C353 		movw	r3, #24003
 1055 002c 1380     		strh	r3, [r2]	@ movhi
 857:rtos/uCOS-III/Source/os_sem.c ****     }
 1056              		.loc 1 857 9 is_stmt 1 view .LVU421
 1057 002e F6E7     		b	.L78
 1058              	.LVL93:
 1059              	.L82:
 868:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 1060              		.loc 1 868 4 view .LVU422
 868:rtos/uCOS-III/Source/os_sem.c ****     CPU_CRITICAL_ENTER();
 1061              		.loc 1 868 11 is_stmt 0 view .LVU423
 1062 0030 0023     		movs	r3, #0
 1063 0032 2B80     		strh	r3, [r5]	@ movhi
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1064              		.loc 1 869 5 is_stmt 1 view .LVU424
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1065              		.loc 1 869 5 view .LVU425
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1066              		.loc 1 869 5 view .LVU426
 1067 0034 4020     		movs	r0, #64
 1068              	.LVL94:
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1069              		.loc 1 869 5 is_stmt 0 view .LVU427
 1070 0036 FFF7FEFF 		bl	CPU_SR_Save
 1071              	.LVL95:
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1072              		.loc 1 869 5 is_stmt 1 view .LVU428
 869:rtos/uCOS-III/Source/os_sem.c ****     if (p_sem->Ctr > 0u) {                                      /* See if semaphore already has a c
 1073              		.loc 1 869 5 view .LVU429
 870:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr = cnt;                                       /* Yes, set it to the new value spe
 1074              		.loc 1 870 5 view .LVU430
 870:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr = cnt;                                       /* Yes, set it to the new value spe
 1075              		.loc 1 870 14 is_stmt 0 view .LVU431
 1076 003a E368     		ldr	r3, [r4, #12]
 870:rtos/uCOS-III/Source/os_sem.c ****         p_sem->Ctr = cnt;                                       /* Yes, set it to the new value spe
 1077              		.loc 1 870 8 view .LVU432
 1078 003c 1BB1     		cbz	r3, .L83
 871:rtos/uCOS-III/Source/os_sem.c ****     } else {
 1079              		.loc 1 871 9 is_stmt 1 view .LVU433
 871:rtos/uCOS-III/Source/os_sem.c ****     } else {
 1080              		.loc 1 871 20 is_stmt 0 view .LVU434
 1081 003e E660     		str	r6, [r4, #12]
 1082              	.L84:
 880:rtos/uCOS-III/Source/os_sem.c **** }
ARM GAS  /tmp/ccmNIA1d.s 			page 41


 1083              		.loc 1 880 5 is_stmt 1 view .LVU435
 880:rtos/uCOS-III/Source/os_sem.c **** }
 1084              		.loc 1 880 5 view .LVU436
 880:rtos/uCOS-III/Source/os_sem.c **** }
 1085              		.loc 1 880 5 view .LVU437
 1086 0040 FFF7FEFF 		bl	CPU_SR_Restore
 1087              	.LVL96:
 880:rtos/uCOS-III/Source/os_sem.c **** }
 1088              		.loc 1 880 5 view .LVU438
 880:rtos/uCOS-III/Source/os_sem.c **** }
 1089              		.loc 1 880 5 view .LVU439
 1090 0044 EBE7     		b	.L78
 1091              	.LVL97:
 1092              	.L83:
 873:rtos/uCOS-III/Source/os_sem.c ****         if (p_pend_list->HeadPtr == (OS_TCB *)0) {              /* See if task(s) waiting?         
 1093              		.loc 1 873 9 view .LVU440
 874:rtos/uCOS-III/Source/os_sem.c ****             p_sem->Ctr = cnt;                                   /* No, OK to set the value         
 1094              		.loc 1 874 9 view .LVU441
 874:rtos/uCOS-III/Source/os_sem.c ****             p_sem->Ctr = cnt;                                   /* No, OK to set the value         
 1095              		.loc 1 874 24 is_stmt 0 view .LVU442
 1096 0046 6368     		ldr	r3, [r4, #4]
 874:rtos/uCOS-III/Source/os_sem.c ****             p_sem->Ctr = cnt;                                   /* No, OK to set the value         
 1097              		.loc 1 874 12 view .LVU443
 1098 0048 1BB1     		cbz	r3, .L89
 877:rtos/uCOS-III/Source/os_sem.c ****         }
 1099              		.loc 1 877 12 is_stmt 1 view .LVU444
 877:rtos/uCOS-III/Source/os_sem.c ****         }
 1100              		.loc 1 877 24 is_stmt 0 view .LVU445
 1101 004a 47F25F13 		movw	r3, #29023
 1102 004e 2B80     		strh	r3, [r5]	@ movhi
 1103 0050 F6E7     		b	.L84
 1104              	.L89:
 875:rtos/uCOS-III/Source/os_sem.c ****         } else {
 1105              		.loc 1 875 13 is_stmt 1 view .LVU446
 875:rtos/uCOS-III/Source/os_sem.c ****         } else {
 1106              		.loc 1 875 24 is_stmt 0 view .LVU447
 1107 0052 E660     		str	r6, [r4, #12]
 1108 0054 F4E7     		b	.L84
 1109              	.L91:
 1110 0056 00BF     		.align	2
 1111              	.L90:
 1112 0058 00000000 		.word	OSIntNestingCtr
 1113 005c 53454D41 		.word	1095583059
 1114              		.cfi_endproc
 1115              	.LFE5:
 1117              		.section	.text.OS_SemClr,"ax",%progbits
 1118              		.align	1
 1119              		.global	OS_SemClr
 1120              		.syntax unified
 1121              		.thumb
 1122              		.thumb_func
 1123              		.fpu fpv4-sp-d16
 1125              	OS_SemClr:
 1126              	.LVL98:
 1127              	.LFB6:
 882:rtos/uCOS-III/Source/os_sem.c **** #endif
 883:rtos/uCOS-III/Source/os_sem.c **** 
ARM GAS  /tmp/ccmNIA1d.s 			page 42


 884:rtos/uCOS-III/Source/os_sem.c **** 
 885:rtos/uCOS-III/Source/os_sem.c **** /*
 886:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 887:rtos/uCOS-III/Source/os_sem.c **** *                                           CLEAR THE CONTENTS OF A SEMAPHORE
 888:rtos/uCOS-III/Source/os_sem.c **** *
 889:rtos/uCOS-III/Source/os_sem.c **** * Description: This function is called by OSSemDel() to clear the contents of a semaphore
 890:rtos/uCOS-III/Source/os_sem.c **** *
 891:rtos/uCOS-III/Source/os_sem.c **** 
 892:rtos/uCOS-III/Source/os_sem.c **** * Argument(s): p_sem      is a pointer to the semaphore to clear
 893:rtos/uCOS-III/Source/os_sem.c **** *              -----
 894:rtos/uCOS-III/Source/os_sem.c **** *
 895:rtos/uCOS-III/Source/os_sem.c **** * Returns    : none
 896:rtos/uCOS-III/Source/os_sem.c **** *
 897:rtos/uCOS-III/Source/os_sem.c **** * Note(s)    : 1) This function is INTERNAL to uC/OS-III and your application MUST NOT call it.
 898:rtos/uCOS-III/Source/os_sem.c **** ***************************************************************************************************
 899:rtos/uCOS-III/Source/os_sem.c **** */
 900:rtos/uCOS-III/Source/os_sem.c **** 
 901:rtos/uCOS-III/Source/os_sem.c **** void  OS_SemClr (OS_SEM  *p_sem)
 902:rtos/uCOS-III/Source/os_sem.c **** {
 1128              		.loc 1 902 1 is_stmt 1 view -0
 1129              		.cfi_startproc
 1130              		@ args = 0, pretend = 0, frame = 0
 1131              		@ frame_needed = 0, uses_anonymous_args = 0
 1132              		.loc 1 902 1 is_stmt 0 view .LVU449
 1133 0000 08B5     		push	{r3, lr}
 1134              	.LCFI8:
 1135              		.cfi_def_cfa_offset 8
 1136              		.cfi_offset 3, -8
 1137              		.cfi_offset 14, -4
 903:rtos/uCOS-III/Source/os_sem.c **** #if (OS_OBJ_TYPE_REQ > 0u)
 904:rtos/uCOS-III/Source/os_sem.c ****     p_sem->Type    = OS_OBJ_TYPE_NONE;                          /* Mark the data structure as a NON
 1138              		.loc 1 904 5 is_stmt 1 view .LVU450
 1139              		.loc 1 904 20 is_stmt 0 view .LVU451
 1140 0002 044B     		ldr	r3, .L94
 1141 0004 0360     		str	r3, [r0]
 905:rtos/uCOS-III/Source/os_sem.c **** #endif
 906:rtos/uCOS-III/Source/os_sem.c ****     p_sem->Ctr     = 0u;                                        /* Set semaphore value             
 1142              		.loc 1 906 5 is_stmt 1 view .LVU452
 1143              		.loc 1 906 20 is_stmt 0 view .LVU453
 1144 0006 0023     		movs	r3, #0
 1145 0008 C360     		str	r3, [r0, #12]
 907:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_TS_EN > 0u)
 908:rtos/uCOS-III/Source/os_sem.c ****     p_sem->TS      = 0u;                                        /* Clear the time stamp            
 909:rtos/uCOS-III/Source/os_sem.c **** #endif
 910:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 911:rtos/uCOS-III/Source/os_sem.c ****     p_sem->NamePtr = (CPU_CHAR *)((void *)"?SEM");
 912:rtos/uCOS-III/Source/os_sem.c **** #endif
 913:rtos/uCOS-III/Source/os_sem.c ****     OS_PendListInit(&p_sem->PendList);                          /* Initialize the waiting list     
 1146              		.loc 1 913 5 is_stmt 1 view .LVU454
 1147 000a 0430     		adds	r0, r0, #4
 1148              	.LVL99:
 1149              		.loc 1 913 5 is_stmt 0 view .LVU455
 1150 000c FFF7FEFF 		bl	OS_PendListInit
 1151              	.LVL100:
 914:rtos/uCOS-III/Source/os_sem.c **** }
 1152              		.loc 1 914 1 view .LVU456
 1153 0010 08BD     		pop	{r3, pc}
ARM GAS  /tmp/ccmNIA1d.s 			page 43


 1154              	.L95:
 1155 0012 00BF     		.align	2
 1156              	.L94:
 1157 0014 4E4F4E45 		.word	1162760014
 1158              		.cfi_endproc
 1159              	.LFE6:
 1161              		.section	.text.OSSemDel,"ax",%progbits
 1162              		.align	1
 1163              		.global	OSSemDel
 1164              		.syntax unified
 1165              		.thumb
 1166              		.thumb_func
 1167              		.fpu fpv4-sp-d16
 1169              	OSSemDel:
 1170              	.LVL101:
 1171              	.LFB1:
 182:rtos/uCOS-III/Source/os_sem.c ****     OS_OBJ_QTY     nbr_tasks;
 1172              		.loc 1 182 1 is_stmt 1 view -0
 1173              		.cfi_startproc
 1174              		@ args = 0, pretend = 0, frame = 0
 1175              		@ frame_needed = 0, uses_anonymous_args = 0
 182:rtos/uCOS-III/Source/os_sem.c ****     OS_OBJ_QTY     nbr_tasks;
 1176              		.loc 1 182 1 is_stmt 0 view .LVU458
 1177 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1178              	.LCFI9:
 1179              		.cfi_def_cfa_offset 24
 1180              		.cfi_offset 3, -24
 1181              		.cfi_offset 4, -20
 1182              		.cfi_offset 5, -16
 1183              		.cfi_offset 6, -12
 1184              		.cfi_offset 7, -8
 1185              		.cfi_offset 14, -4
 1186 0002 1646     		mov	r6, r2
 183:rtos/uCOS-III/Source/os_sem.c ****     OS_PEND_LIST  *p_pend_list;
 1187              		.loc 1 183 5 is_stmt 1 view .LVU459
 184:rtos/uCOS-III/Source/os_sem.c ****     OS_TCB        *p_tcb;
 1188              		.loc 1 184 5 view .LVU460
 185:rtos/uCOS-III/Source/os_sem.c ****     CPU_TS         ts;
 1189              		.loc 1 185 5 view .LVU461
 186:rtos/uCOS-III/Source/os_sem.c ****     CPU_SR_ALLOC();
 1190              		.loc 1 186 5 view .LVU462
 187:rtos/uCOS-III/Source/os_sem.c **** 
 1191              		.loc 1 187 5 view .LVU463
 1192              	.LVL102:
 197:rtos/uCOS-III/Source/os_sem.c **** 
 1193              		.loc 1 197 39 view .LVU464
 208:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_DEL_ISR);
 1194              		.loc 1 208 5 view .LVU465
 208:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_DEL_ISR);
 1195              		.loc 1 208 25 is_stmt 0 view .LVU466
 1196 0004 2B4B     		ldr	r3, .L113
 1197 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 208:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_DEL_ISR);
 1198              		.loc 1 208 8 view .LVU467
 1199 0008 53B9     		cbnz	r3, .L110
 1200 000a 0546     		mov	r5, r0
 1201 000c 0C46     		mov	r4, r1
ARM GAS  /tmp/ccmNIA1d.s 			page 44


 216:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OS_NOT_RUNNING);
 1202              		.loc 1 216 5 is_stmt 1 view .LVU468
 216:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OS_NOT_RUNNING);
 1203              		.loc 1 216 19 is_stmt 0 view .LVU469
 1204 000e 2A4B     		ldr	r3, .L113+4
 1205 0010 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 216:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OS_NOT_RUNNING);
 1206              		.loc 1 216 8 view .LVU470
 1207 0012 012B     		cmp	r3, #1
 1208 0014 0AD0     		beq	.L99
 217:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OS_NOT_RUNNING;
 1209              		.loc 1 217 53 is_stmt 1 view .LVU471
 218:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1210              		.loc 1 218 8 view .LVU472
 218:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1211              		.loc 1 218 15 is_stmt 0 view .LVU473
 1212 0016 45F68963 		movw	r3, #24201
 1213 001a 1380     		strh	r3, [r2]	@ movhi
 219:rtos/uCOS-III/Source/os_sem.c ****     }
 1214              		.loc 1 219 9 is_stmt 1 view .LVU474
 219:rtos/uCOS-III/Source/os_sem.c ****     }
 1215              		.loc 1 219 16 is_stmt 0 view .LVU475
 1216 001c 0024     		movs	r4, #0
 1217 001e 03E0     		b	.L98
 1218              	.L110:
 209:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_DEL_ISR;
 1219              		.loc 1 209 46 is_stmt 1 view .LVU476
 210:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1220              		.loc 1 210 8 view .LVU477
 210:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1221              		.loc 1 210 15 is_stmt 0 view .LVU478
 1222 0020 43F2C923 		movw	r3, #13001
 1223 0024 1380     		strh	r3, [r2]	@ movhi
 211:rtos/uCOS-III/Source/os_sem.c ****     }
 1224              		.loc 1 211 9 is_stmt 1 view .LVU479
 211:rtos/uCOS-III/Source/os_sem.c ****     }
 1225              		.loc 1 211 16 is_stmt 0 view .LVU480
 1226 0026 0024     		movs	r4, #0
 1227              	.LVL103:
 1228              	.L98:
 292:rtos/uCOS-III/Source/os_sem.c **** #endif
 1229              		.loc 1 292 1 view .LVU481
 1230 0028 2046     		mov	r0, r4
 1231 002a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1232              	.LVL104:
 1233              	.L99:
 224:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_PTR_NULL);
 1234              		.loc 1 224 5 is_stmt 1 view .LVU482
 224:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_PTR_NULL);
 1235              		.loc 1 224 8 is_stmt 0 view .LVU483
 1236 002c 40B1     		cbz	r0, .L111
 232:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_TYPE);
 1237              		.loc 1 232 5 is_stmt 1 view .LVU484
 232:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_TYPE);
 1238              		.loc 1 232 14 is_stmt 0 view .LVU485
 1239 002e 0268     		ldr	r2, [r0]
 1240              	.LVL105:
ARM GAS  /tmp/ccmNIA1d.s 			page 45


 232:rtos/uCOS-III/Source/os_sem.c ****         OS_TRACE_SEM_DEL_EXIT(OS_ERR_OBJ_TYPE);
 1241              		.loc 1 232 8 view .LVU486
 1242 0030 224B     		ldr	r3, .L113+8
 1243 0032 9A42     		cmp	r2, r3
 1244 0034 09D0     		beq	.L101
 233:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_TYPE;
 1245              		.loc 1 233 47 is_stmt 1 view .LVU487
 234:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1246              		.loc 1 234 8 view .LVU488
 234:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1247              		.loc 1 234 15 is_stmt 0 view .LVU489
 1248 0036 45F6C453 		movw	r3, #24004
 1249 003a 3380     		strh	r3, [r6]	@ movhi
 235:rtos/uCOS-III/Source/os_sem.c ****     }
 1250              		.loc 1 235 9 is_stmt 1 view .LVU490
 235:rtos/uCOS-III/Source/os_sem.c ****     }
 1251              		.loc 1 235 16 is_stmt 0 view .LVU491
 1252 003c 0024     		movs	r4, #0
 1253 003e F3E7     		b	.L98
 1254              	.LVL106:
 1255              	.L111:
 225:rtos/uCOS-III/Source/os_sem.c ****        *p_err = OS_ERR_OBJ_PTR_NULL;
 1256              		.loc 1 225 51 is_stmt 1 view .LVU492
 226:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1257              		.loc 1 226 8 view .LVU493
 226:rtos/uCOS-III/Source/os_sem.c ****         return (0u);
 1258              		.loc 1 226 15 is_stmt 0 view .LVU494
 1259 0040 45F6C353 		movw	r3, #24003
 1260 0044 1380     		strh	r3, [r2]	@ movhi
 227:rtos/uCOS-III/Source/os_sem.c ****     }
 1261              		.loc 1 227 9 is_stmt 1 view .LVU495
 227:rtos/uCOS-III/Source/os_sem.c ****     }
 1262              		.loc 1 227 16 is_stmt 0 view .LVU496
 1263 0046 0024     		movs	r4, #0
 1264 0048 EEE7     		b	.L98
 1265              	.LVL107:
 1266              	.L101:
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1267              		.loc 1 239 5 is_stmt 1 view .LVU497
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1268              		.loc 1 239 5 view .LVU498
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1269              		.loc 1 239 5 view .LVU499
 1270 004a 4020     		movs	r0, #64
 1271              	.LVL108:
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1272              		.loc 1 239 5 is_stmt 0 view .LVU500
 1273 004c FFF7FEFF 		bl	CPU_SR_Save
 1274              	.LVL109:
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1275              		.loc 1 239 5 view .LVU501
 1276 0050 0746     		mov	r7, r0
 1277              	.LVL110:
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1278              		.loc 1 239 5 is_stmt 1 view .LVU502
 239:rtos/uCOS-III/Source/os_sem.c ****     p_pend_list = &p_sem->PendList;
 1279              		.loc 1 239 5 view .LVU503
ARM GAS  /tmp/ccmNIA1d.s 			page 46


 240:rtos/uCOS-III/Source/os_sem.c ****     nbr_tasks   = 0u;
 1280              		.loc 1 240 5 view .LVU504
 241:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {
 1281              		.loc 1 241 5 view .LVU505
 242:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_DEL_NO_PEND:                                /* Delete semaphore only if no task
 1282              		.loc 1 242 5 view .LVU506
 1283 0052 44B1     		cbz	r4, .L102
 1284 0054 012C     		cmp	r4, #1
 1285 0056 2BD0     		beq	.L107
 284:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 1286              		.loc 1 284 14 view .LVU507
 284:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 1287              		.loc 1 284 14 view .LVU508
 284:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 1288              		.loc 1 284 14 view .LVU509
 1289 0058 FFF7FEFF 		bl	CPU_SR_Restore
 1290              	.LVL111:
 284:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 1291              		.loc 1 284 14 view .LVU510
 284:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_OPT_INVALID;
 1292              		.loc 1 284 14 view .LVU511
 285:rtos/uCOS-III/Source/os_sem.c ****              break;
 1293              		.loc 1 285 13 view .LVU512
 285:rtos/uCOS-III/Source/os_sem.c ****              break;
 1294              		.loc 1 285 20 is_stmt 0 view .LVU513
 1295 005c 45F62563 		movw	r3, #24101
 1296 0060 3380     		strh	r3, [r6]	@ movhi
 286:rtos/uCOS-III/Source/os_sem.c ****     }
 1297              		.loc 1 286 14 is_stmt 1 view .LVU514
 241:rtos/uCOS-III/Source/os_sem.c ****     switch (opt) {
 1298              		.loc 1 241 17 is_stmt 0 view .LVU515
 1299 0062 0024     		movs	r4, #0
 286:rtos/uCOS-III/Source/os_sem.c ****     }
 1300              		.loc 1 286 14 view .LVU516
 1301 0064 E0E7     		b	.L98
 1302              	.LVL112:
 1303              	.L102:
 244:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 1304              		.loc 1 244 14 is_stmt 1 view .LVU517
 244:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 1305              		.loc 1 244 29 is_stmt 0 view .LVU518
 1306 0066 6B68     		ldr	r3, [r5, #4]
 244:rtos/uCOS-III/Source/os_sem.c **** #if (OS_CFG_DBG_EN > 0u)
 1307              		.loc 1 244 17 view .LVU519
 1308 0068 2BB1     		cbz	r3, .L112
 254:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 1309              		.loc 1 254 18 is_stmt 1 view .LVU520
 254:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 1310              		.loc 1 254 18 view .LVU521
 254:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 1311              		.loc 1 254 18 view .LVU522
 1312 006a FFF7FEFF 		bl	CPU_SR_Restore
 1313              	.LVL113:
 254:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 1314              		.loc 1 254 18 view .LVU523
 254:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_TASK_WAITING;
 1315              		.loc 1 254 18 view .LVU524
ARM GAS  /tmp/ccmNIA1d.s 			page 47


 255:rtos/uCOS-III/Source/os_sem.c ****              }
 1316              		.loc 1 255 17 view .LVU525
 255:rtos/uCOS-III/Source/os_sem.c ****              }
 1317              		.loc 1 255 24 is_stmt 0 view .LVU526
 1318 006e 47F25F13 		movw	r3, #29023
 1319 0072 3380     		strh	r3, [r6]	@ movhi
 1320 0074 D8E7     		b	.L98
 1321              	.LVL114:
 1322              	.L112:
 249:rtos/uCOS-III/Source/os_sem.c ****                  OS_SemClr(p_sem);
 1323              		.loc 1 249 41 is_stmt 1 view .LVU527
 250:rtos/uCOS-III/Source/os_sem.c ****                  CPU_CRITICAL_EXIT();
 1324              		.loc 1 250 18 view .LVU528
 1325 0076 2846     		mov	r0, r5
 1326              	.LVL115:
 250:rtos/uCOS-III/Source/os_sem.c ****                  CPU_CRITICAL_EXIT();
 1327              		.loc 1 250 18 is_stmt 0 view .LVU529
 1328 0078 FFF7FEFF 		bl	OS_SemClr
 1329              	.LVL116:
 251:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 1330              		.loc 1 251 18 is_stmt 1 view .LVU530
 251:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 1331              		.loc 1 251 18 view .LVU531
 251:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 1332              		.loc 1 251 18 view .LVU532
 1333 007c 3846     		mov	r0, r7
 1334 007e FFF7FEFF 		bl	CPU_SR_Restore
 1335              	.LVL117:
 251:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 1336              		.loc 1 251 18 view .LVU533
 251:rtos/uCOS-III/Source/os_sem.c ****                 *p_err = OS_ERR_NONE;
 1337              		.loc 1 251 18 view .LVU534
 252:rtos/uCOS-III/Source/os_sem.c ****              } else {
 1338              		.loc 1 252 17 view .LVU535
 252:rtos/uCOS-III/Source/os_sem.c ****              } else {
 1339              		.loc 1 252 24 is_stmt 0 view .LVU536
 1340 0082 0023     		movs	r3, #0
 1341 0084 3380     		strh	r3, [r6]	@ movhi
 1342 0086 CFE7     		b	.L98
 1343              	.LVL118:
 1344              	.L106:
 266:rtos/uCOS-III/Source/os_sem.c ****                  OS_PendAbort(p_tcb,
 1345              		.loc 1 266 18 is_stmt 1 view .LVU537
 267:rtos/uCOS-III/Source/os_sem.c ****                               ts,
 1346              		.loc 1 267 18 view .LVU538
 1347 0088 0222     		movs	r2, #2
 1348 008a 0021     		movs	r1, #0
 1349 008c FFF7FEFF 		bl	OS_PendAbort
 1350              	.LVL119:
 270:rtos/uCOS-III/Source/os_sem.c ****              }
 1351              		.loc 1 270 18 view .LVU539
 270:rtos/uCOS-III/Source/os_sem.c ****              }
 1352              		.loc 1 270 27 is_stmt 0 view .LVU540
 1353 0090 0134     		adds	r4, r4, #1
 1354              	.LVL120:
 270:rtos/uCOS-III/Source/os_sem.c ****              }
 1355              		.loc 1 270 27 view .LVU541
ARM GAS  /tmp/ccmNIA1d.s 			page 48


 1356 0092 A4B2     		uxth	r4, r4
 1357              	.LVL121:
 1358              	.L103:
 265:rtos/uCOS-III/Source/os_sem.c ****                  p_tcb = p_pend_list->HeadPtr;
 1359              		.loc 1 265 20 is_stmt 1 view .LVU542
 265:rtos/uCOS-III/Source/os_sem.c ****                  p_tcb = p_pend_list->HeadPtr;
 1360              		.loc 1 265 32 is_stmt 0 view .LVU543
 1361 0094 6868     		ldr	r0, [r5, #4]
 265:rtos/uCOS-III/Source/os_sem.c ****                  p_tcb = p_pend_list->HeadPtr;
 1362              		.loc 1 265 20 view .LVU544
 1363 0096 0028     		cmp	r0, #0
 1364 0098 F6D1     		bne	.L106
 276:rtos/uCOS-III/Source/os_sem.c ****              OS_SemClr(p_sem);
 1365              		.loc 1 276 37 is_stmt 1 view .LVU545
 277:rtos/uCOS-III/Source/os_sem.c ****              CPU_CRITICAL_EXIT();
 1366              		.loc 1 277 14 view .LVU546
 1367 009a 2846     		mov	r0, r5
 1368 009c FFF7FEFF 		bl	OS_SemClr
 1369              	.LVL122:
 278:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
 1370              		.loc 1 278 14 view .LVU547
 278:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
 1371              		.loc 1 278 14 view .LVU548
 278:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
 1372              		.loc 1 278 14 view .LVU549
 1373 00a0 3846     		mov	r0, r7
 1374 00a2 FFF7FEFF 		bl	CPU_SR_Restore
 1375              	.LVL123:
 278:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
 1376              		.loc 1 278 14 view .LVU550
 278:rtos/uCOS-III/Source/os_sem.c ****              OSSched();                                         /* Find highest priority task ready
 1377              		.loc 1 278 14 view .LVU551
 279:rtos/uCOS-III/Source/os_sem.c ****             *p_err = OS_ERR_NONE;
 1378              		.loc 1 279 14 view .LVU552
 1379 00a6 FFF7FEFF 		bl	OSSched
 1380              	.LVL124:
 280:rtos/uCOS-III/Source/os_sem.c ****              break;
 1381              		.loc 1 280 13 view .LVU553
 280:rtos/uCOS-III/Source/os_sem.c ****              break;
 1382              		.loc 1 280 20 is_stmt 0 view .LVU554
 1383 00aa 0023     		movs	r3, #0
 1384 00ac 3380     		strh	r3, [r6]	@ movhi
 281:rtos/uCOS-III/Source/os_sem.c **** 
 1385              		.loc 1 281 14 is_stmt 1 view .LVU555
 1386 00ae BBE7     		b	.L98
 1387              	.LVL125:
 1388              	.L107:
 242:rtos/uCOS-III/Source/os_sem.c ****         case OS_OPT_DEL_NO_PEND:                                /* Delete semaphore only if no task
 1389              		.loc 1 242 5 is_stmt 0 view .LVU556
 1390 00b0 0024     		movs	r4, #0
 1391 00b2 EFE7     		b	.L103
 1392              	.L114:
 1393              		.align	2
 1394              	.L113:
 1395 00b4 00000000 		.word	OSIntNestingCtr
 1396 00b8 00000000 		.word	OSRunning
 1397 00bc 53454D41 		.word	1095583059
ARM GAS  /tmp/ccmNIA1d.s 			page 49


 1398              		.cfi_endproc
 1399              	.LFE1:
 1401              		.text
 1402              	.Letext0:
 1403              		.file 2 "rtos/uC-CPU/ARM-Cortex-M/ARMv7-M/GNU/cpu.h"
 1404              		.file 3 "rtos/uC-CPU/cpu_core.h"
 1405              		.file 4 "rtos/uCOS-III/Source/os_type.h"
 1406              		.file 5 "rtos/uCOS-III/Source/os.h"
 1407              		.file 6 "rtos/uCOS-III/Ports/ARM-Cortex-M/ARMv7-M/GNU/os_cpu.h"
ARM GAS  /tmp/ccmNIA1d.s 			page 50


DEFINED SYMBOLS
                            *ABS*:0000000000000000 os_sem.c
     /tmp/ccmNIA1d.s:18     .text.OSSemCreate:0000000000000000 $t
     /tmp/ccmNIA1d.s:26     .text.OSSemCreate:0000000000000000 OSSemCreate
     /tmp/ccmNIA1d.s:149    .text.OSSemCreate:0000000000000054 $d
     /tmp/ccmNIA1d.s:155    .text.OSSemPend:0000000000000000 $t
     /tmp/ccmNIA1d.s:162    .text.OSSemPend:0000000000000000 OSSemPend
     /tmp/ccmNIA1d.s:363    .text.OSSemPend:00000000000000b4 $d
     /tmp/ccmNIA1d.s:367    .text.OSSemPend:00000000000000b8 $t
     /tmp/ccmNIA1d.s:505    .text.OSSemPend:0000000000000120 $d
     /tmp/ccmNIA1d.s:514    .text.OSSemPendAbort:0000000000000000 $t
     /tmp/ccmNIA1d.s:521    .text.OSSemPendAbort:0000000000000000 OSSemPendAbort
     /tmp/ccmNIA1d.s:729    .text.OSSemPendAbort:00000000000000b8 $d
     /tmp/ccmNIA1d.s:736    .text.OSSemPost:0000000000000000 $t
     /tmp/ccmNIA1d.s:743    .text.OSSemPost:0000000000000000 OSSemPost
     /tmp/ccmNIA1d.s:983    .text.OSSemPost:00000000000000c4 $d
     /tmp/ccmNIA1d.s:989    .text.OSSemSet:0000000000000000 $t
     /tmp/ccmNIA1d.s:996    .text.OSSemSet:0000000000000000 OSSemSet
     /tmp/ccmNIA1d.s:1112   .text.OSSemSet:0000000000000058 $d
     /tmp/ccmNIA1d.s:1118   .text.OS_SemClr:0000000000000000 $t
     /tmp/ccmNIA1d.s:1125   .text.OS_SemClr:0000000000000000 OS_SemClr
     /tmp/ccmNIA1d.s:1157   .text.OS_SemClr:0000000000000014 $d
     /tmp/ccmNIA1d.s:1162   .text.OSSemDel:0000000000000000 $t
     /tmp/ccmNIA1d.s:1169   .text.OSSemDel:0000000000000000 OSSemDel
     /tmp/ccmNIA1d.s:1395   .text.OSSemDel:00000000000000b4 $d
                           .group:0000000000000000 wm4.0.0f5aa60db9403f389c005f20ecce4286
                           .group:0000000000000000 wm4.os.h.38.05c7a360e844508f9424830362f7eef3
                           .group:0000000000000000 wm4.os_cfg.h.36.1682609214807c39119743015cd1b75b
                           .group:0000000000000000 wm4.os_cfg_app.h.36.9d01bed009cfc3a5184d9a87250e45bf
                           .group:0000000000000000 wm4.cpu_core.h.51.7b35a59c319673f88ae4a256248776ec
                           .group:0000000000000000 wm4.cpu_def.h.46.baa122a2898bdc40bb50d1f21ead1515
                           .group:0000000000000000 wm4.cpu_cfg.h.45.38a6a562da8b04490c382a226238c57e
                           .group:0000000000000000 wm4.cpu.h.171.3cb15ee3ccb812cbfdf76d1fbfb9eda0
                           .group:0000000000000000 wm4.lib_def.h.66.6ab2a012067a8e1f4289db5765835062
                           .group:0000000000000000 wm4.cpu_core.h.143.d3b700e12b3a14ed3bee14c822b49a7d
                           .group:0000000000000000 wm4.os_cpu.h.45.281d793567585e56a091270c28fc7efc
                           .group:0000000000000000 wm4.os_trace.h.37.a6badbf6e748c370e142a9584653748e
                           .group:0000000000000000 wm4.os.h.95.7b45e7e080367d299efd03f7510809bc

UNDEFINED SYMBOLS
CPU_SR_Save
OS_PendListInit
CPU_SR_Restore
OSIntNestingCtr
OS_Pend
OSSched
OSRunning
OSSchedLockNestingCtr
OSTCBCurPtr
OS_PendAbort
OS_Post
